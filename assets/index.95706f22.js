var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i,s=(e,s)=>{for(var n in s||(s={}))a.call(s,n)&&l(e,n,s[n]);if(t)for(var n of t(s))i.call(s,n)&&l(e,n,s[n]);return e};import{o as n,c as o,a as r,v as c,b as d,E as u,d as m,C as g,e as p,f as h,g as _,h as f,i as v,u as b,j as y,k as w,r as I,l as k,m as x,n as S,p as T,w as O,t as L,q as C,s as $,x as E,y as D,z as A,F as R,A as P,B as N,D as U,G as z,H as G,I as M,J as j,K as H,L as B,M as V,N as F,O as X,P as W,Q as q,R as J,S as K,T as Z,U as Y,V as Q,W as ee,X as te,Y as ae,Z as ie,_ as le,$ as se,a0 as ne,a1 as oe,a2 as re,a3 as ce,a4 as de,a5 as ue,a6 as me,a7 as ge,a8 as pe,a9 as he,aa as _e,ab as fe,ac as ve,ad as be,ae as ye,af as we,ag as Ie,ah as ke,ai as xe,aj as Se,ak as Te,al as Oe,am as Le,an as Ce,ao as $e,ap as Ee,aq as De,ar as Ae,as as Re,at as Pe,au as Ne,av as Ue,aw as ze,ax as Ge}from"./vendor.cefe23a2.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Me={},je={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},He=[r("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896a448 448 0 0 1 0-896m-55.808 536.384l-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.27 38.27 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"},null,-1)];var Be={name:"ep-circle-check-filled",render:function(e,t){return n(),o("svg",je,[...He])}};const Ve={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Fe=[r("path",{fill:"currentColor",d:"M715.648 625.152L670.4 579.904l90.496-90.56c75.008-74.944 85.12-186.368 22.656-248.896c-62.528-62.464-173.952-52.352-248.96 22.656L444.16 353.6l-45.248-45.248l90.496-90.496c100.032-99.968 251.968-110.08 339.456-22.656c87.488 87.488 77.312 239.424-22.656 339.456l-90.496 90.496zm-90.496 90.496l-90.496 90.496C434.624 906.112 282.688 916.224 195.2 828.8c-87.488-87.488-77.312-239.424 22.656-339.456l90.496-90.496l45.248 45.248l-90.496 90.56c-75.008 74.944-85.12 186.368-22.656 248.896c62.528 62.464 173.952 52.352 248.96-22.656l90.496-90.496zm0-362.048l45.248 45.248L398.848 670.4L353.6 625.152z"},null,-1)];var Xe={name:"ep-link",render:function(e,t){return n(),o("svg",Ve,[...Fe])}};const We={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},qe=[r("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"},null,-1)];var Je={name:"ep-document",render:function(e,t){return n(),o("svg",We,[...qe])}};const Ke="picx-images-hosting",Ze="PicX image hosting repository",Ye="master",Qe="gh-pages",et="Init repo via PicX (https://github.com/XPoet/picx)",tt=(e,t)=>({type:"dir",dir:e,dirPath:t,childrenDirs:[],imageList:[]});function at(e,t,a){var i;return e?t.length===a?e:at(null==(i=e.childrenDirs)?void 0:i.find((e=>e.dir===t[a])),t,++a):null}const it=(e,t)=>{if("/"===e)return t;return at(t,e.split("/"),0)},lt=(e,t,a)=>{var i;return"dir"===a?null==(i=t.childrenDirs)?void 0:i.filter((e=>"dir"===e.type)):"image"===a?t.imageList.filter((e=>"image"===e.type)):[]},st={state:{name:"dirImageListModule",dirObject:(()=>{const e=localStorage.getItem("PICX_MANAGEMENT");return e?JSON.parse(e):tt("/","/")})()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},a){if("/"===a)return;const i=(e,t,a)=>{if(e){e.childrenDirs.some((e=>e.dir===t))||e.childrenDirs.push(tt(t,a));return e.childrenDirs.find((e=>e.dir===t))||tt(t,a)}return tt(t,a)},l=a.split("/");let s="",n=e.dirObject;for(let o=0,r=l.length;o<r;o++){const e=l[o];s+=`${o>0?"/":""}${e}`,n=i(n,e,s),0===o&&t("USER_CONFIG_INFO_ADD_DIR",e)}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},a){if("/"===a)return;const i=a.split("/");let l=e.dirObject;i.forEach(((t,a)=>{l=((t,a,i)=>{if("/"===a)return e.dirObject;const l=t.childrenDirs.find((e=>e.dir===a));if(!l)return t;if(i){const e=t.childrenDirs.findIndex((e=>e.dir===a));-1!==e&&t.childrenDirs.splice(e,1)}return l})(l,t,a===i.length-1)})),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},a){let i=e.dirObject;if("/"===a.dir)i.imageList.some((e=>e.name===a.name))||i.imageList.push(a);else{const t=a.dir.split("/");let l="";t.forEach(((s,n)=>{l+=`${n>0?"/":""}${s}`,i=((t,a,i,l,s=!1)=>{var n;if(!t)return e.dirObject;let o=null==(n=t.childrenDirs)?void 0:n.find((e=>e.dir===a));return o||(o={type:"dir",dir:a,dirPath:i,childrenDirs:[],imageList:[]},t.childrenDirs.push(o)),s&&!o.imageList.some((e=>e.name===l.name))&&o.imageList.push(l),o})(i,s,l,a,n===t.length-1)}))}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},a){const i=(e,t)=>{if(e.length){const a=e.findIndex((e=>e.uuid===t));-1!==a&&e.splice(a,1)}},{dir:l,uuid:s}=a;if("/"===l)return i(e.dirObject.imageList,s),void t("DIR_IMAGE_LIST_PERSIST");const n=l.split("/");let o=e.dirObject;n.forEach(((l,s)=>{if(o=((t,a,l,s)=>{if(!t)return e.dirObject;const n=t.childrenDirs.find((e=>e.dir===a));return n?(n.dir===a&&s&&i(n.imageList,l.uuid),n):e.dirObject})(o,l,a,s===n.length-1),!o.imageList.length&&!o.childrenDirs.length){const a=(e=>{if("/"===e)return[];const t=e.split("/"),a=[];let i="";return t.forEach(((e,t)=>{i+=`${t>0?"/":""}${e}`,a.unshift(i)})),a})(o.dirPath);a.forEach((a=>{const i=it(a,e.dirObject);if(i&&!i.imageList.length&&!i.childrenDirs.length){const{dirPath:e}=(e=>{if("/"===e)return{currentDir:"/",dirPath:"/"};const t=e.split("/");return 1===t.length?{currentDir:"/",dirPath:"/"}:t.length>1?(t.length-=1,{currentDir:t[t.length-1],dirPath:t.join("/")}):{currentDir:"/",dirPath:"/"}})(a),i=e,l=e;let s=l.split("/");"/"===e&&(s=[],t("USER_CONFIG_INFO_REMOVE_DIR",a)),t("SET_USER_CONFIG_INFO",{viewDir:i,selectedDir:l,selectedDirList:s}),t("DIR_IMAGE_LIST_REMOVE_DIR",a)}}))}}))},DIR_IMAGE_LIST_INIT_DIR({state:e,dispatch:t},a){let i=e.dirObject;if("/"===a)return i.imageList=[],i.childrenDirs=[],void t("DIR_IMAGE_LIST_PERSIST");const l=a.split("/");l.forEach(((t,a)=>{i=((t,a,i)=>{var l;if(!t)return e.dirObject;const s=null==(l=t.childrenDirs)?void 0:l.find((e=>e.dir===a));return s?(i&&(s.imageList=[],s.childrenDirs=[]),s):e.dirObject})(i,t,a===l.length-1)})),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem("PICX_MANAGEMENT",JSON.stringify(e.dirObject))},DIR_IMAGE_LOGOUT({state:e,dispatch:t}){e.dirObject=tt("/","/"),t("DIR_IMAGE_LIST_PERSIST")}},getters:{getDirObject:e=>e.dirObject}};var nt,ot,rt,ct,dt,ut,mt,gt,pt,ht,_t,ft,vt,bt,yt,wt,It,kt,xt,St,Tt,Ot;(ot=nt||(nt={})).uploaded="uploaded",ot.allUploaded="allUploaded",ot.uploadFail="uploadFail",(ct=rt||(rt={})).deleted="deleted",ct.allDeleted="allDeleted",ct.deleteFail="deleteFail",(ut=dt||(dt={})).mozJPEG="mozJPEG",ut.avif="avif",ut.webP="webP",(gt=mt||(mt={})).GitHub="GitHub",gt.GitHubPages="GitHub Pages",gt.jsDelivr="jsDelivr",gt.ChinaJsDelivr="ChinaJsDelivr",gt.Statically="Statically",(ht=pt||(pt={})).newBranch="newBranch",ht.repoBranch="repoBranch",(ft=_t||(_t={})).autoDir="autoDir",ft.newDir="newDir",ft.rootDir="rootDir",ft.repoDir="repoDir",(bt=vt||(vt={})).large="large",bt.default="default",bt.small="small",(wt=yt||(yt={})).leftTop="leftTop",wt.leftBottom="leftBottom",wt.rightTop="rightTop",wt.rightBottom="rightBottom",(kt=It||(It={})).system="system",kt.light="light",kt.dark="dark",(St=xt||(xt={})).zhCN="zh-CN",St.zhTW="zh-TW",St.en="en",(Ot=Tt||(Tt={}))[Ot.parentDir=0]="parentDir",Ot[Ot.childDir=1]="childDir",Ot[Ot.img=2]="img";var Lt={repo:"仓库",branch:"分支",dir:"目录",tips:"提示",delete:"删除",reset:"重置",confirm:"确定",cancel:"取消",author:"作者",document:"文档",shortcut_key:"快捷键",copy_link:"复制图片链接",copy_success_1:"图片链接已自动复制到系统剪贴板",copy_success_2:"图片链接复制成功",copy_fail_1:"复制失败",header:{not_login:"未登录",login:"登录",logout:"退出登录",language:"语言",theme:"主题",usage_count:"使用次数"},nav:{login:"登录",config:"图床配置",upload:"上传图片",management:"图床管理",settings:"我的设置",toolbox:"工具箱",feedback:"帮助反馈",actions:"快捷操作"},actions:{watermark:"添加水印",compress:"压缩图片",transform:"转换 "},settings:{img_name:{title:"图片名称设置",hash_switch_name:"自动哈希化",hash_switch_desc:"上传前自动给图片名增加哈希码，确保图片名唯一，强烈建议开启",prefix_switch_name:"添加前缀命名",prefix_switch_desc:"上传前自动给图片名增加前缀，例如：abc-image.jpg，abc- 为前缀",prefix_input_placeholder:"请输入命名前缀 ...",timestamp_switch_name:"自动时间戳命名"},img_watermark:{title:"图片水印设置",switch_name:"是否添加水印",switch_desc:"开启后可以自定义水印文字、字体大小、位置、颜色和透明度",text:"水印文字",text_input_placeholder:"请输入水印文字，限制 20 字",size:"水印大小",color:"水印颜色",opacity:"水印透明度",position:"水印位置",position_1:"左上角",position_2:"左下角",position_3:"右上角",position_4:"右下角"},img_compress:{title:"图片压缩设置",switch_name:"是否压缩图片",switch_desc:"开启后上传前会自动压缩图片，有效缩短图片上传和加载时间，强烈建议开启",radio_group_title:"选择图片压缩算法",radio_1:"webP",radio_1_desc:"压缩后图片格式为 webp，压缩率较高，大多数浏览器支持",radio_2:"mozJPEG",radio_2_desc:"压缩后图片格式为 jpg，兼容性最好，所有浏览器支持",radio_3:"avif",radio_3_desc:"压缩后图片格式为 avif，压缩率极高，部分现代浏览器支持"},link_rule:{title:"图片链接规则配置",select_title:"选择图片链接规则",card_title:"配置自定义图片链接规则",card_table_col_title_1:"类型",card_table_col_title_2:"图片链接规则",card_table_col_title_3:"操作",input_name_1:"图片链接类型",input_name_1_rule:"图片链接类型名称不能为空",input_name_2:"图片链接规则",input_name_2_rule:"图片链接规则不能为空",btn_name_1:"添加图片链接规则",error_msg_1:"添加失败，该图片链接规则已存在",error_msg_2:"{action}失败，图片链接规则必须包含 {path}",error_msg_3:"图片链接规则缺少 {rules}，是否确认{action}？",add:"添加",edit:"编辑"},link_format:{title:"图片链接格式设置",switch_name:"自动转换图片链接格式",switch_desc:"上传成功后复制的图片链接自动转换成 {type} 格式",select_title:"选择图片链接格式",delete_tips:"此操作将永久删除图片链接规则"},image_hosting_deploy:{title:"图床部署",one_click_deploy:"一键部署",deploy_to:"部署到 {server}",success:"部署成功",fail:"部署失败",fail2:"部署失败，请稍后再试",deploying:"正在部署到 GitHub Pages，该过程持续 1 分钟左右，请耐心等待 ...",not_deployed:"未部署"},theme:{title:"主题设置",system:"跟随系统",dark:"暗夜",light:"白昼"},cloud_settings:{tip_1:"检测到你的设置数据未保存到云端仓库，是否保存？",tip_2:"检测到你的云端仓库有设置文件，是否使用？",tip_3:"检测到你的设置数据有变化，是否同步到云端仓库？",tip_4:"本地设置数据和云端仓库设置数据一致",success_msg_1:"保存成功",success_msg_2:"更新成功"}},config:{inputToken:"请输入 GitHub Token ...",manualConfiguration1:"手动配置",manualConfiguration2:"重新手动配置",manualConfiguration3:"使用已有的 GitHub 仓库，逐步完成配置",autoConfiguration1:"一键自动配置",autoConfiguration2:"重新一键自动配置",autoConfiguration3:"自动创建 GitHub 仓库（推荐）",username:"用户名",email:"邮箱",selectRepo:"选择仓库",selectBranch:"选择分支",loading1:"正在加载用户信息 ...",loading2:"正在加载分支信息 ...",loading3:"正在加载用户信息 ...",loading4:"正在加载{type}数据 ...",loading5:"正在加载目录信息 ...",loading6:"正在自动配置 ...",placeholder1:"请选择图床仓库 ...",placeholder2:"请选择分支 ...",placeholder3:"请输入新建的分支 ...",placeholder4:"请输入新建的目录 ...",placeholder5:"请选择一个目录 ...",message1:"GitHub Token 不能为空",message2:"用户信息获取失败，请确认 Token 是否正确",message3:"自动创建 GitHub 仓库失败，请稍后再试",message4:"自动配置成功",message5:"一键自动配置失败，请重试",message6:"目录不能为空",message7:"请输入一个新目录",message8:"请选择 {repo} 仓库里的一个目录",message9:"仓库信息获取失败，请稍后重试",message11:"用户信息获取失败，请确认 GitHub Token 是否有效",selectBranch2:"选择 {repo}} 仓库里的分支",reload:"重新载入所有{type}数据",dirMode:"目录模式",inputNewDir:"手动输入一个新目录",createNewDir:"新建目录",rootDir:"根目录",rootDir2:"图片存储在 {branch} 分支的根目录下",autoDir:"自动目录",autoDir2:"根据日期自动创建格式 yyyyMMdd 的目录",repoDir:"选择 {repo} 仓库目录",repoDir2:"选择 {branch} 分支里的一个目录",selectDir:"选择目录"},upload:{uploadAreaTips:"拖拽 / 粘贴 / 点击此处选择图片",uploaded:"已上传",upload:"上传",message1:"请先完成图床配置",message2:"请选择一个仓库",message3:"目录不能为空",message4:"请选择要上传的图片",message5:"图片上传成功",message6:"图片批量上传成功",message7:"上传失败，请稍后重试",message8:"图片上传成功",fold:"折叠",expand:"展开",hash:"哈希化",rename:"重命名","timestamp-naming":"时间戳命名",prefixNaming:"前缀命名",delete:"删除",copyLink:"复制图片链接",loading1:"正在上传 ..."},management:{reload:"重新加载 {dir} 目录所有数据",loadingTxt1:"加载中 ...",loadingTxt2:"正在重命名 ...",loadingTxt3:"删除中 ...",back:"双击后退",toNextDir:"双击进入下一级目录",property:"属性",delTips:"此操作将会永久删除图片",delTips2:"已选中 {total} 张图片，是否批量删除？",renameTips:"该图片重命名为 {name} ？",message1:"图片名不能为空",message2:"图片名无改变",message3:"重命名失败",message4:"更新成功",message5:"删除成功",message6:"批量删除成功",message7:"删除失败，请稍后重试",imageName:"图片名称",imageSize:"图片大小",selectAll:"全选",deselectAll:"取消全选",unselect:"取消选择",batchCopy:"批量复制图片链接",batchDelete:"批量删除图片",selectTotal:"已选择 {total} 张图片",contextmenu_1:"从当前位置上传新图片",contextmenu_2:"上传图片到 < {dir} >",contextmenu_3:"根目录"},toolbox:{tool_1:"图片压缩",tool_1_desc:"不限制图片大小和数量，不上传至服务器的离线极致压缩",tool_2:"图片转 Base64",tool_2_desc:"不限制图片大小和数量，在线转换成 Base64 编码",tool_3:"图片水印 ",tool_3_desc:"自定义水印文字、字体大小、位置、颜色和透明度",copy_base64:"点击复制 Base64 编码",copy_base64_success:"Base64 编码复制成功",click_download:"点击下载",compress:"压缩",batch_download:"批量下载",add_watermark:"添加水印"},feedback:{text_1:"PicX 是一款基于 GitHub API 开发的图床工具，提供图片上传托管、生成图片链接和常用图片工具箱服务。",text_2:"建议将本站添加到浏览器收藏夹，方便下次使用。",text_3:"如果 PicX 对你有帮助，欢迎赞赏作者，支持开源。",text_4:"郑重声明：请勿使用 PicX 上传违反你当地法律的图片，所造成的一切后果与作者无关。"},region:{CN:"中国大陆",HK:"中国香港",MO:"中国澳门",TW:"中国台湾",SG:"新加坡",JP:"日本",US:"美国",NL:"荷兰"},language:{"zh-CN":"中文简体","zh-TW":"中文繁体",en:"英文"},toggle_language_msg:"检测到你的 IP 所属地为{region}，是否切换{language}？",authorization:{msg_1:"GitHub OAuth 授权登录已过期，请重新授权",msg_2:"未在 GitHub 安装 PicX APP，暂无操作权限",msg_3:"PicX GitHub APP 安装成功，是否进行授权登录？",msg_4:"授权失败，稍后重试",btn_1:"立即安装",loading_1:"正在授权登录...",text_1:"GitHub OAuth 授权登录",text_2:"填写 GitHub Token 登录",text_3:"正在使用 GitHub OAuth 授权登录",text_4:"GitHub Token 已过期，请重新授权登录",text_5:"正在使用填写 GitHub Token 登录",text_6:"返回登录页",text_7:"切换",text_8:"使用 GitHub OAuth 授权登录必须安装 PicX GitHub APP",text_9:"填写 GitHub Token 登录必须生成具有操作权限的 Token",text_10:"查看教程",text_11:"安装 PicX GitHub APP",text_12:"创建 GitHub Token"}};var Ct={repo:"倉庫",branch:"分支",dir:"目錄",tips:"提示",delete:"刪除",reset:"重置",confirm:"確定",cancel:"取消",author:"作者",document:"文檔",shortcut_key:"快捷鍵",copy_link:"復製圖片鏈接",copy_success_1:"圖片鏈接已自動復製到系統剪貼板",copy_success_2:"圖片鏈接復製成功",copy_fail_1:"復製失敗",header:{not_login:"未登錄",login:"登錄",logout:"退出登錄",language:"語言",theme:"主題",usage_count:"使用次數"},nav:{login:"登錄",config:"圖床配置",upload:"上傳圖片",management:"圖床管理",settings:"我的設置",toolbox:"工具箱",feedback:"幫助反饋",actions:"快捷操作"},actions:{watermark:"添加水印",compress:"壓縮圖片",transform:"轉換 "},settings:{img_name:{title:"圖片名稱設置",hash_switch_name:"自動哈希化",hash_switch_desc:"上傳前自動給圖片名增加哈希碼，確保圖片名唯一，強烈建議開啟",prefix_switch_name:"添加前綴命名",prefix_switch_desc:"上傳前自動給圖片名增加前綴，例如：abc-image.jpg，abc- 為前綴",prefix_input_placeholder:"請輸入命名前綴 ...",timestamp_switch_name:"自動時間戳命名"},img_watermark:{title:"圖片水印設置",switch_name:"是否添加水印",switch_desc:"開啟後可以自定義水印文字、字體大小、位置、顏色和透明度",text:"水印文字",text_input_placeholder:"請輸入水印文字，限製 20 字",size:"水印大小",color:"水印顏色",opacity:"水印透明度",position:"水印位置",position_1:"左上角",position_2:"左下角",position_3:"右上角",position_4:"右下角"},img_compress:{title:"圖片壓縮設置",switch_name:"是否壓縮圖片",switch_desc:"開啟後上傳前會自動壓縮圖片，有效縮短圖片上傳和加載時間，強烈建議開啟",radio_group_title:"選擇圖片壓縮算法",radio_1:"webP",radio_1_desc:"壓縮後圖片格式為 webp，壓縮率較高，大多數瀏覽器支持",radio_2:"mozJPEG",radio_2_desc:"壓縮後圖片格式為 jpg，兼容性最好，所有瀏覽器支持",radio_3:"avif",radio_3_desc:"壓縮後圖片格式為 avif，壓縮率極高，部分現代瀏覽器支持"},link_rule:{title:"圖片鏈接規則配置",select_title:"選擇圖片鏈接規則",card_title:"配置自定義圖片鏈接規則",card_table_col_title_1:"類型",card_table_col_title_2:"圖片鏈接規則",card_table_col_title_3:"操作",input_name_1:"圖片鏈接類型",input_name_1_rule:"圖片鏈接類型名稱不能為空",input_name_2:"圖片鏈接規則",input_name_2_rule:"圖片鏈接規則不能為空",btn_name_1:"新增圖片鏈接規則",error_msg_1:"新增失敗，該圖片連結規則已存在",error_msg_2:"{action}失敗，圖片連結規則必須包含 {path}",error_msg_3:"圖片連結規則缺少 {rules}，是否確認{action}？",add:"新增",edit:"編輯"},link_format:{title:"圖片鏈接格式設置",switch_name:"自動轉換圖片鏈接格式",switch_desc:"上傳成功後復製的圖片鏈接自動轉換成 {type} 格式",select_title:"選擇圖片鏈接格式",delete_tips:"此操作將永久刪除圖片鏈接規則"},image_hosting_deploy:{title:"圖床部署",one_click_deploy:"一鍵部署",deploy_to:"部署到 {server}",success:"部署成功",fail:"部署失敗",fail2:"部署失敗，請稍後再試",deploying:"正在部署到 GitHub Pages，該過程持續 1 分鐘左右，請耐心等待 ...",not_deployed:"未部署"},theme:{title:"主題設置",system:"跟隨系統",dark:"暗夜",light:"白晝"},cloud_settings:{tip_1:"偵測到你的設定資料未儲存到雲端倉庫，是否儲存？",tip_2:"偵測到你的雲端倉庫有設定文件，是否使用？",tip_3:"偵測到你的設定資料有變化，是否同步到雲端倉庫？",tip_4:"本地設定資料與雲端倉庫設定資料一致",success_msg_1:"儲存成功",success_msg_2:"更新成功"}},config:{inputToken:"請輸入 GitHub Token ...",manualConfiguration1:"手動配置",manualConfiguration2:"重新手動配置",manualConfiguration3:"使用已有的 GitHub 倉庫，逐步完成配置",autoConfiguration1:"一鍵自動配置",autoConfiguration2:"重新一鍵自動配置",autoConfiguration3:"自動創建 GitHub 倉庫（推薦）",username:"用戶名",email:"郵箱",selectRepo:"選擇倉庫",selectBranch:"選擇分支",loading1:"正在加載用戶信息 ...",loading2:"正在加載分支信息 ...",loading3:"正在加載用戶信息 ...",loading4:"正在加載{type}數據 ...",loading5:"正在加載目錄信息 ...",loading6:"正在自動配置 ...",placeholder1:"請選擇圖床倉庫 ...",placeholder2:"請選擇分支 ...",placeholder3:"請輸入新建的分支 ...",placeholder4:"請輸入新建的目錄 ...",placeholder5:"請選擇一個目錄 ...",message1:"GitHub Token 不能為空",message2:"用戶信息獲取失敗，請確認 Token 是否正確",message3:"自動創建 GitHub 倉庫失敗，請稍後再試",message4:"自動配置成功",message5:"一鍵自動配置失敗，請重試",message6:"目錄不能為空",message7:"請輸入一個新目錄",message8:"請選擇 {repo} 倉庫裏的一個目錄",message9:"倉庫信息獲取失敗，請稍後重試",message11:"用戶信息獲取失敗，請確認 GitHub Token 是否有效",selectBranch2:"選擇 {repo}} 倉庫裏的分支",reload:"重新載入所有{type}數據",dirMode:"目錄模式",inputNewDir:"手動輸入一個新目錄",createNewDir:"新建目錄",rootDir:"根目錄",rootDir2:"圖片存儲在 {branch} 分支的根目錄下",autoDir:"自動目錄",autoDir2:"根據日期自動創建格式 yyyyMMdd 的目錄",repoDir:"選擇 {repo} 倉庫目錄",repoDir2:"選擇 {branch} 分支裏的一個目錄",selectDir:"選擇目錄"},upload:{uploadAreaTips:"拖拽 / 粘貼 / 點擊此處選擇圖片",uploaded:"已上傳",upload:"上傳",message1:"請先完成圖床配置",message2:"請選擇一個倉庫",message3:"目錄不能為空",message4:"請選擇要上傳的圖片",message5:"圖片上傳成功",message6:"圖片批量上傳成功",message7:"上傳失敗，請稍後重試",message8:"圖片上傳成功",fold:"折疊",expand:"展開",hash:"哈希化",rename:"重命名","timestamp-naming":"時間戳命名",prefixNaming:"前綴命名",delete:"刪除",copyLink:"復製圖片鏈接",loading1:"正在上傳 ..."},management:{reload:"重新加載 {dir} 目錄所有數據",loadingTxt1:"加載中 ...",loadingTxt2:"正在重命名 ...",loadingTxt3:"刪除中 ...",back:"雙擊後退",toNextDir:"雙擊進入下一級目錄",property:"屬性",delTips:"此操作將會永久刪除圖片",delTips2:"已選中 {total} 張圖片，是否批量刪除？",renameTips:"該圖片重命名為 {name} ？",message1:"圖片名不能為空",message2:"圖片名無改變",message3:"重命名失敗",message4:"更新成功",message5:"刪除成功",message6:"批量刪除成功",message7:"刪除失敗，請稍後重試",imageName:"圖片名稱",imageSize:"圖片大小",selectAll:"全選",deselectAll:"取消全選",unselect:"取消選擇",batchCopy:"批量復製圖片鏈接",batchDelete:"批量刪除圖片",selectTotal:"已選擇 {total} 張圖片",contextmenu_1:"從當前位置上傳新圖片",contextmenu_2:"上傳圖片到 < {dir} >",contextmenu_3:"根目錄"},toolbox:{tool_1:"圖片壓縮",tool_1_desc:"不限製圖片大小和數量，不上傳至服務器的離線極致壓縮",tool_2:"圖片轉 Base64",tool_2_desc:"不限製圖片大小和數量，在線轉換成 Base64 編碼",tool_3:"圖片水印 ",tool_3_desc:"自定義水印文字、字體大小、位置、顏色和透明度",copy_base64:"點擊復製 Base64 編碼",copy_base64_success:"Base64 編碼復製成功",click_download:"點擊下載",compress:"壓縮",batch_download:"批量下載",add_watermark:"添加水印"},feedback:{text_1:"PicX 是一款基於 GitHub API 開發的圖床工具，提供圖片上傳托管、生成圖片鏈接和常用圖片工具箱服務。",text_2:"建議將本站添加到瀏覽器收藏夾，方便下次使用。",text_3:"如果 PicX 對你有幫助，歡迎贊賞作者，支持開源。",text_4:"鄭重聲明：請勿使用 PicX 上傳違反你當地法律的圖片，所造成的一切後果與作者無關。"},region:{CN:"中國大陸",HK:"中國香港",MO:"中国澳门",TW:"中國臺灣",SG:"新加坡",JP:"日本",US:"美國",NL:"荷蘭"},language:{"zh-CN":"中文簡體","zh-TW":"中文繁體",en:"英文"},toggle_language_msg:"檢測到你的 IP 所屬地為{region}，是否切換{language}？",authorization:{msg_1:"GitHub OAuth 授權登入已過期，請重新授權",msg_2:"未在 GitHub 安裝 PicX APP，暫無操作權限",msg_3:"PicX GitHub APP 安裝成功，是否進行授權登入？",msg_4:"授權失敗，稍後重試",btn_1:"立即安裝",loading_1:"正在授權登入...",text_1:"GitHub OAuth 授權登入",text_2:"填入 GitHub Token 登入",text_3:"正在使用 GitHub OAuth 授權登入",text_4:"GitHub Token 已過期，請重新授權登入",text_5:"正在使用填入 GitHub Token 登入",text_6:"返回登入頁面",text_7:"切換",text_8:"使用 GitHub OAuth 授權登入必須安裝 PicX GitHub APP",text_9:"填寫 GitHub Token 登入必須產生具有操作權限的 Token",text_10:"檢視教學",text_11:"安裝 PicX GitHub APP",text_12:"建立 GitHub Token"}};var $t={repo:"Repository",branch:"Branch",dir:"Directory",tips:"Tips",delete:"Delete",reset:"Reset",confirm:"Confirm",cancel:"Cancel",author:"Author",document:"Document",shortcut_key:"Shortcut key",copy_link:"Copy image link",copy_success_1:"The image link has been automatically copied to the system clipboard",copy_success_2:"Image link copied successfully",copy_fail_1:"Copy failed",header:{not_login:"Not log in",login:"Log in",logout:"Log out",language:"Language",theme:"Theme",usage_count:"Usage count"},nav:{login:"Log in",config:"Image Hosting Config",upload:"Upload Image",management:"Image Hosting Management",settings:"My Settings",toolbox:"Toolbox",feedback:"Feedback",actions:"Quick actions"},actions:{compress:"Compress Image",watermark:"Add Watermark",transform:"Transform "},settings:{img_name:{title:"Image Name Settings",hash_switch_name:"Hashing",hash_switch_desc:"Automatically add a hash code to the image name before uploading to ensure uniqueness. It is strongly recommended to turn on this feature.",prefix_switch_name:"Add Prefix",prefix_switch_desc:"Automatically add a prefix to the image name before uploading. For example: abc-image.jpg, where abc- is the prefix.",prefix_input_placeholder:"Please enter the name prefix...",timestamp_switch_name:"Automatically timestamp naming"},img_watermark:{title:"Image Watermark Settings",switch_name:"Add Watermark",switch_desc:"After turning on this feature, you can customize the watermark text, font size, position, color, and transparency.",text:"Text",text_input_placeholder:"Please enter the watermark text, limited to 20 characters.",size:"Size",color:"Color",opacity:"Opacity",position:"Position",position_1:"Top Left",position_2:"Bottom Left",position_3:"Top Right",position_4:"Bottom Right"},img_compress:{title:"Image Compression Settings",switch_name:"Compress Images",switch_desc:"After enable, the image will be auto compressed before uploading, which can effectively shorten the image upload and loading time. It is strongly recommended enable.",radio_group_title:"Select image compression algorithm",radio_1:"WebP",radio_1_desc:"The compressed image format is webp, which has a higher compression ratio and is supported by most browsers.",radio_2:"MozJPEG",radio_2_desc:"The compressed image format is jpg, which has the best compatibility and is supported by all browsers.",radio_3:"AVIF",radio_3_desc:"The compressed image format is avif, which has an extremely high compression ratio and is supported by some modern browsers."},link_rule:{title:"Image Link Rules Configuration",select_title:"Select Image Link Rule",card_title:"Configure Custom Image Link Rules",card_table_col_title_1:"Type",card_table_col_title_2:"Image Link Rule",card_table_col_title_3:"Action",input_name_1:"Link Type",input_name_1_rule:"The Image Link Type Name cannot be empty.",input_name_2:"Link Rule",input_name_2_rule:"The Image Link Rule cannot be empty.",btn_name_1:"Add Image Link Rule",error_msg_1:"Failed to add, the image link rule already exists",error_msg_2:"{action} failed, image link rule must contain {path}",error_msg_3:"The image link rule is missing {rules}. Do you want to confirm {action}?",add:"add",edit:"edit"},link_format:{title:"Image Link Format Settings",switch_name:"Automatically Convert Image Link Format",switch_desc:"After a successful upload, the copied image link will be automatically converted to the {type} format.",select_title:"Select Image Link Format",delete_tips:"This operation will permanently delete the image link rule"},image_hosting_deploy:{title:"Image hosting deployment",one_click_deploy:"One-click deployment",deploy_to:"Deploy to {server}",success:"Deployment successful",fail:"Deployment failed",fail2:"Deployment failed, please try again later",deploying:"Deploying to GitHub Pages, this process will take about 1 minute, please wait patiently...",not_deployed:"Not deployed"},theme:{title:"Theme Settings",system:"System",dark:"Dark",light:"Light"},cloud_settings:{tip_1:"It is detected that your settings data is not saved to the cloud repository. Do you want to save it?",tip_2:"It is detected that your cloud repository has a configuration file. Do you want to use it?",tip_3:"It is detected that your settings data has changed. Do you want to synchronize it to the cloud repository?",tip_4:"The local settings data is consistent with the cloud repository settings data",success_msg_1:"Save successfully",success_msg_2:"Update successful"}},config:{inputToken:"Please input GitHub Token ...",manualConfiguration1:"Manual Configuration",manualConfiguration2:"Reconfigure Manually",manualConfiguration3:"Configure using an existing GitHub repository step by step",autoConfiguration1:"One-click Automatic Configuration",autoConfiguration2:"Reconfigure Automatically",autoConfiguration3:"Automatically create a GitHub repository (Recommend)",username:"Username",email:"Email",selectRepo:"Select Repo",selectBranch:"Select Branch",loading1:"Loading user information ...",loading2:"Loading branch information ...",loading3:"Loading user information ...",loading4:"Loading {type} data ...",loading5:"Loading directory information ...",loading6:"Automatically configuring ...",placeholder1:"Please select image hosting repository ...",placeholder2:"Please select branch ...",placeholder3:"Please enter the name of new branch ...",placeholder4:"Please enter the newly created directory ...",placeholder5:"Please select a directory ...",message1:"GitHub token cannot be empty",message2:"Failed to retrieve user information, please verify that the token is correct",message3:"Failed to automatically create GitHub repository, please try again later",message4:"Automated configuration successful",message5:"One-click automated configuration failed, please try again.",message6:"Directory cannot be empty",message7:"Please enter a new directory",message8:"Please select a directory in the {repo} repository",message9:"Failed to retrieve repository information, please try again later",message11:"Failed to retrieve user information, please verify that the GitHub Token is valid",reload:"Reload all {type} data",dirMode:"Dir Mode",inputNewDir:"Manually input a new directory",createNewDir:"New Dir",rootDir:"Root Dir",rootDir2:"Images are stored in the root directory of {branch} branch",autoDir:"Auto Dir",autoDir2:"Automatically create a directory with format yyyyMMdd",repoDir:"Select directory in {repo} repository",repoDir2:"Choose a directory in the {branch} branch",selectDir:"Select Dir"},upload:{uploadAreaTips:"Drag / Paste / Click here to select images",uploaded:"Uploaded",upload:"Upload",message1:"Please complete the image hosting configuration first",message2:"Please select a repository",message3:"Directory cannot be empty",message4:"Please select an image to upload",message5:"Image uploaded successfully",message6:"Images uploaded successfully in batch",message7:"Upload failed, please try again later",message8:"Image uploaded successfully",fold:"Fold",expand:"Expand",hash:"Hashing",rename:"Rename","timestamp-naming":"Timestamp Naming",prefixNaming:"Prefix Naming",delete:"Delete",copyLink:"Copy image link",loading1:"Uploading ..."},management:{reload:"Reload all data in the {dir} directory",loadingTxt1:"Loading ...",loadingTxt2:"Renaming ...",loadingTxt3:"Deleting ...",back:"Double-click back",toNextDir:"Double-click to enter the next level directory",property:"Property",delTips:"This operation will permanently delete the image",delTips2:"Are you sure you want to delete the selected {total} images in bulk?",renameTips:"Rename this picture to {name}?",message1:"Image name cannot be empty",message2:"Image name unchanged",message3:"Rename failed",message4:"Update successfully",message5:"Delete successfully",message6:"Batch delete successfully",message7:"Deletion failed, please try again later",imageName:"Image name",imageSize:"Image size",selectAll:"Select all",deselectAll:"Deselect all",unselect:"Unselect",batchCopy:"Batch copy image link",batchDelete:"Batch delete image",selectTotal:"Selected {total} images",contextmenu_1:"Upload new image from current location",contextmenu_2:"Upload image to < {dir} >",contextmenu_3:"Root directory"},toolbox:{tool_1:"Image Compressor",tool_1_desc:"Offline ultimate compression without size or quantity limit, and without uploading to server",tool_2:"Image to Base64",tool_2_desc:"Online conversion of images to Base64 encoding without size or quantity limit",tool_3:"Image Watermark",tool_3_desc:"Customize watermark text, font size, position, color and opacity",copy_base64:"Click to copy Base64 encoding",copy_base64_success:"Base64 encoding copied successfully",click_download:"Click to download",compress:"Compress",batch_download:"Batch Download",add_watermark:"Add Watermark"},feedback:{text_1:"PicX is a GitHub API based image hosting tool, providing image upload and hosting, generating image links, and a set of commonly used image tools.",text_2:"We suggest adding our website to your browser bookmarks for easy future access.",text_3:"If PicX is helpful to you, please consider donating to the author to support open source development.",text_4:"Disclaimer: Do not upload images that violate the laws in your local jurisdiction. The author is not responsible for any consequences arising from such actions."},region:{CN:"Mainland China",HK:"Hong Kong, China",MO:"Macao, China",TW:"Taiwan, China",SG:"Singapore",JP:"Japan",US:"United States",NL:"Netherlands"},language:{"zh-CN":"Simplified Chinese","zh-TW":"Traditional Chinese",en:"English"},toggle_language_msg:"We detected that your IP is located in {region}. Do you want to switch to {language}?",authorization:{msg_1:"GitHub OAuth authorization login has expired, please re-authorize",msg_2:"PicX APP is not installed on GitHub and has no operation permission yet",msg_3:"PicX GitHub APP is installed successfully. Do you want to authorize the login?",msg_4:"Authorization failed, try again later",btn_1:"Install now",loading_1:"Authorizing login...",text_1:"GitHub OAuth authorization login",text_2:"Fill in GitHub Token to log in",text_3:"Login using GitHub OAuth authorization",text_4:"GitHub Token has expired, please authorize your login again",text_5:"Logging in using GitHub Token",text_6:"Return to login page",text_7:"Switch",text_8:"PicX GitHub APP must be installed to log in using GitHub OAuth authorization",text_9:"Filling in the GitHub Token to log in must generate a Token with operation permissions",text_10:"View tutorial",text_11:"Install PicX GitHub APP",text_12:"Create GitHub Token"}};const Et=c.createI18n({locale:"zh-CN",messages:{"zh-CN":Lt,"zh-TW":Ct,en:$t}}),Dt=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},At=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),Rt=(e,t)=>{navigator.clipboard.writeText(e).then((()=>{t&&t()}))},Pt=e=>{for(const t in e)switch(Dt(e[t])){case"object":Pt(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1}},Nt=(e,t)=>{for(const a in t)"object"!==Dt(t[a])?e[a]=t[a]:(Object.hasOwn(e,a)||(e[a]={}),Nt(e[a],t[a]))},Ut=(e="yyyy-MM-dd hh:mm:ss",t=Date.now())=>{function a(e){return`00${e}`.substr(e.length)}const i=new Date(t);/(y+)/.test(e)&&(e=e.replace(RegExp.$1,`${i.getFullYear()}`.substr(4-RegExp.$1.length)));const l={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds()};for(const s in l)if(new RegExp(`(${s})`).test(e)){const t=`${l[s]}`;e=e.replace(RegExp.$1,1===RegExp.$1.length?t:a(t))}return e},zt=e=>{e&&(window.document.title=`${Et.global.t(e)} | PicX`)},Gt=(e,t)=>{function a(e){const t={};for(const[i,l]of Object.entries(e))if("object"==typeof l&&null!==l){const e=a(l);for(const[a,l]of Object.entries(e))t[`${i}.${a}`]=l}else t[i]=l;return t}return Object.entries(a(e)).toString()===Object.entries(a(t)).toString()};async function Mt(e,t){const{text:a,fontSize:i,position:l,textColor:s,opacity:n}=t,[o,r,c]=(d=s,d?(d=d.replace("#",""),`${parseInt(d.substring(0,2),16)}, ${parseInt(d.substring(2,4),16)}, ${parseInt(d.substring(4,6),16)}`):"255,255,255").split(",");var d;const u=await function(e){return new Promise(((t,a)=>{const i=new FileReader;i.onload=()=>{const e=new Image;e.setAttribute("crossOrigin","Anonymous"),e.onload=()=>t(e),e.onerror=a,e.src=i.result},i.onerror=a,i.readAsDataURL(e)}))}(e),m=document.createElement("canvas"),g=m.getContext("2d");m.width=u.width,m.height=u.height,g.drawImage(u,0,0),g.font=`bold ${i}px Arial`,g.strokeStyle=`rgba(0, 0, 0, ${n})`,g.lineWidth=3,g.fillStyle=`rgba(${o}, ${r}, ${c}, ${n})`;let p=0,h=0;switch(l){case yt.leftTop:p=10,h=i+5;break;case yt.rightTop:p=m.width-g.measureText(a).width-10,h=i+5;break;case yt.leftBottom:p=10,h=m.height-15;break;case yt.rightBottom:p=m.width-g.measureText(a).width-10,h=m.height-15}return g.strokeText(a,p,h),g.fillText(a,p,h),new Promise((t=>{m.toBlob((a=>{if(a){const i=new File([a],e.name,{type:e.type});t(i)}else t(null)}),e.type)}))}const jt=e=>{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null},Ht="https://api.github.com",Bt=d.create({baseURL:Ht,timeout:3e5});function Vt(e){const t={};e.method=e.method.toUpperCase();for(const a in e)"params"===a?"GET"===e.method?t.params=e.params:t.data=e.params:t[a]=e[a];return new Promise((e=>{Bt.request(t).then((t=>{const{status:a,data:i}=t;e(!t||200!==a&&201!==a&&204!==a?null:i||"SUCCESS")})).catch((a=>{var i;if((null==t?void 0:t.success422)&&422===(null==a?void 0:a.status))e((null==a?void 0:a.data)||"SUCCESS");else{const l=null==a?void 0:a.status,s=null==(i=null==a?void 0:a.data)?void 0:i.message;(null==t?void 0:t.noShowErrorMsg)||(console.error("PicX Error // ",a),void 0!==l&&void 0!==s&&u.error({duration:6e3,message:`Code: ${l}, Message: ${s}`})),e(null)}}))}))}Bt.defaults.headers["Content-Type"]="application/json",Bt.interceptors.request.use((e=>{var t;const a=jt("PICX_CONFIG");if(a){const{token:i}=a;(null==(t=e.baseURL)?void 0:t.includes(Ht))&&i&&(e.headers.Authorization=`Bearer ${i}`)}return e}),(e=>Promise.reject(e))),Bt.interceptors.response.use((e=>e),(e=>((null==e?void 0:e.response)||u.error({duration:6e3,message:`${e}`}),Promise.reject(e.response))));const Ft=(e,t="")=>{const{owner:a,selectedRepo:i,selectedBranch:l}=e;return new Promise((async e=>{const s=await Vt({url:`/repos/${a}/${i}/contents/${t}`,method:"GET",params:{ref:l}});s&&s.length?e(s.filter((e=>"dir"===e.type)).map((e=>({value:e.name,label:e.name})))):e(null)}))},Xt=(e,t="")=>{const{owner:a,selectedRepo:i,selectedBranch:l}=e;return new Promise((async e=>{const s=await Vt({url:`/repos/${a}/${i}/contents/${t}`,method:"GET",params:{"no-cache":At(),ref:l}});s&&s.length?(s.filter((e=>"dir"===e.type)).forEach((e=>Oa.dispatch("DIR_IMAGE_LIST_ADD_DIR",e.path))),setTimeout((()=>{s.filter((e=>"file"===e.type&&oa(na(e.name)))).forEach((e=>{Oa.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",ea(e,t))}))}),120),e(!0)):e(null)}))},Wt=(e,t,a)=>Vt({url:`/repos/${e}/${t}/branches/${a}`,method:"GET"}),qt=(e,t)=>new Promise((async a=>{const i=await Vt({url:`/repos/${e}/${t}/branches`,method:"GET",cache:{maxAge:0},params:{timestamp:Date.now()}});i&&i.length?a(i.filter((e=>!e.protected)).map((e=>({value:e.name,label:e.name}))).reverse()):a([])})),Jt=(e,t,a,i)=>Vt({url:`/repos/${e}/${t}/contents/${a}`,method:"DELETE",data:{owner:e,repo:t,path:a,message:"Delete image via PicX (https://github.com/XPoet/picx)",sha:i}}),Kt=(e,t,a)=>Vt({url:`/repos/${t}/${a}/git/blobs`,method:"POST",params:{owner:t,repo:a,content:(e.base64.compressBase64||e.base64.watermarkBase64||e.base64.originalBase64).split(",")[1],encoding:"base64"}}),Zt=(e,t,a,i)=>{var l,s,n;return Vt({url:`/repos/${e}/${t}/git/trees`,method:"POST",params:{tree:a.map((e=>({path:e.path,mode:"100644",type:"blob",sha:e.sha}))),base_tree:(null==(n=null==(s=null==(l=null==i?void 0:i.commit)?void 0:l.commit)?void 0:s.tree)?void 0:n.sha)||null}})},Yt=(e,t,a,i)=>Vt({url:`/repos/${e}/${t}/git/commits`,method:"POST",params:{tree:a.sha,parents:[i.commit.sha],message:"Upload images via PicX (https://github.com/XPoet/picx)"}}),Qt=(e,t,a,i)=>Vt({url:`/repos/${e}/${t}/git/refs/heads/${a}`,method:"PATCH",params:{sha:i}}),ea=(e,t)=>({type:"image",uuid:At(),dir:t,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size,checked:!1});const ta=(e,t=!1)=>{e.forEach((e=>{e.deleting=t}))};async function aa(e,t){if(1===e.length)return await async function(e,t){e.deleting=!0;const{owner:a,selectedRepo:i}=t,{path:l,sha:s}=e;return new Promise((async t=>{const n=await Jt(a,i,l,s);e.deleting=!1,n?(t(!0),await Oa.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),await Oa.dispatch("DIR_IMAGE_LIST_REMOVE",e)):t(!1)}))}(e[0],t)?rt.deleted:rt.deleteFail;try{return await async function(e,t){ta(e,!0);const{owner:a,selectedRepo:i,selectedBranch:l}=t,s=await Wt(a,i,l);if(!s)throw ta(e,!1),new Error("获取分支信息失败");const n=await Zt(a,i,e.map((e=>({path:e.path,sha:null}))),s);if(!n)throw ta(e,!1),new Error("创建 tree 失败");const o=await Yt(a,i,n,s);if(!o)throw ta(e,!1),new Error("创建 commit 失败");if(!(await Qt(a,i,l,o.sha)))throw ta(e,!1),new Error("更新 ref 失败");e.forEach((e=>{e.deleting=!1,Oa.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),Oa.dispatch("DIR_IMAGE_LIST_REMOVE",e)}))}(e,t),rt.allDeleted}catch(a){return console.error(a),rt.deleteFail}}function ia(e){return new Promise((t=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>{const e=a.result;t(e)},a.onerror=()=>t(null)}))}function la(e){const t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=e.name,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)}const sa=e=>{const t=e.indexOf(".");return e.substr(0,t).trim().replace(/\s+/g,"-")},na=e=>{const t=e.lastIndexOf(".");return e.slice(t+1)},oa=e=>/(png|jpg|jpeg|gif|webp|awebp|avif|svg\+xml|svg|x-icon|vnd.microsoft.icon)$/.test(e),ra=e=>e?Number((e/1024).toFixed(0)):e,ca=e=>new Promise((async t=>{e||t(null),oa(e.type)||(u.error(`${e.name} 不是图片格式`),t(null));const a=await ia(e)||"";ra(a.length)>=30720&&(u.error(`${e.name} 超过 30 MB，跳过选择`),t(null)),t({uuid:At(),base64:a,file:e})})),da=async(e,t)=>{if(a=e.type,/(png|jpg|jpeg|webp|avif)$/.test(a)){return new g(e,{encoderState:{type:t,options:p[t].meta.defaultOptions},processorState:h,preprocessorState:_}).process()}var a;return e},ua=(e,t,a)=>{const{selected:i}=a.imageLinkType,{rule:l}=a.imageLinkType.presetList[i];if(l){const{owner:a,selectedRepo:i,selectedBranch:s}=t;return l.replaceAll("{{owner}}",a).replaceAll("{{repo}}",i).replaceAll("{{branch}}",s).replaceAll("{{path}}",e.path)}return null},ma=(e,t,a)=>{var i;if(a.imageLinkFormat.enable){const l=a.imageLinkFormat.selected,s=null==(i=a.imageLinkFormat.presetList.find((e=>e.name===l)))?void 0:i.format;if(s)return s.replaceAll("imageLink",e||"").replaceAll("imageName",t.split(".")[0])}return e},ga=(e=!1)=>{const t=e?Et.global.t("copy_success_1"):Et.global.t("copy_success_2");u({type:e?"info":"success",message:t,duration:e?6e3:4e3})},pa=(e,t,a,i=!1)=>{const l=ma(ua(e,t,a),e.name,a);l?Rt(l,(()=>{ga(i)})):u.error({message:Et.global.t("copy_fail_1")})},ha=(e,t,a,i=!1)=>{if((null==e?void 0:e.length)>0){let l="";e.forEach(((i,s)=>{const n=ma(ua(i,t,a),i.name,a);l+=`${n}${s<e.length-1?"\n":""}`})),Rt(l,(()=>{ga(i)}))}},_a=()=>{const{platform:e}=navigator;return e.includes("Mac")?"mac":e.includes("Win")?"win":e.includes("Linux")?"linux":null},fa=()=>{const e={token:"",id:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepo:"",repoList:[],branchMode:pt.repoBranch,branchList:[],selectedBranch:"",selectedDir:"",dirMode:_t.repoDir,dirList:[],logined:!1,selectedDirList:[],viewDir:""},t=localStorage.getItem("PICX_CONFIG");return t?(Nt(e,JSON.parse(t)),e.selectedBranch&&!e.branchList.length&&(e.branchList=[{value:e.selectedBranch,label:e.selectedBranch}]),e.dirMode===_t.autoDir&&(e.selectedDir=Ut("yyyyMMdd")),e):e},va={state:{userConfigInfo:fa()},actions:{USER_CONFIG_INFO_RESET({state:e}){e.userConfigInfo=fa()},SET_USER_CONFIG_INFO({state:e,dispatch:t},a){for(const i in a)e.userConfigInfo.hasOwnProperty(i)&&(e.userConfigInfo[i]=a[i]);t("USER_CONFIG_INFO_PERSIST")},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},a){e.userConfigInfo.dirList.some((e=>e.value===a))||(e.userConfigInfo.dirList.push({label:a,value:a}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},a){const{dirList:i}=e.userConfigInfo;if(i.some((e=>e.value===a))){const e=i.findIndex((e=>e.value===a));i.splice(e,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){(e=>{const{selectedDir:t,selectedBranch:a,dirMode:i}=e.userConfigInfo;if("newDir"===i){const a=t.split("");let i=0,l="";const s=[" ",".","、",",","，","!","？","?"];for(let e=0;e<a.length&&(s.some((t=>t===a[e]))&&(a[e]="-"),"/"===a[e]&&(i+=1),!(i>=5));e++)l+=a[e];e.userConfigInfo.selectedDir=l}e.userConfigInfo.selectedBranch=a.replace(/\s+/g,"-")})(e),localStorage.setItem("PICX_CONFIG",JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){Pt(e.userConfigInfo)}},getters:{getUserLoginStatus:e=>e.userConfigInfo.logined,getUserConfigInfo:e=>e.userConfigInfo,getUserViewDir:e=>e.userConfigInfo.viewDir}},ba={state:{imgCardArr:[]},mutations:{IMAGE_CARD(e,{imageObj:t}){const{uuid:a,checked:i}=t;i&&e.imgCardArr.forEach((e=>{e.uuid===a&&(e.checked=!0)}))},REPLACE_IMAGE_CARD(e,{checkedImgArr:t}){t.length>0?e.imgCardArr=t:e.imgCardArr=[]}},actions:{},getters:{getImageCardArr:e=>e.imgCardArr,getImageCardCheckedArr:e=>e.imgCardArr.filter((e=>e.checked))}},ya={state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},getters:{getUploadAreaActive:e=>e.uploadAreaActive}};var wa,Ia,ka,xa;(Ia=wa||(wa={}))[Ia.add=0]="add",Ia[Ia.edit=1]="edit",(xa=ka||(ka={}))[xa.githubPages=0]="githubPages",xa[xa.vervel=1]="vervel";const Sa=(e,t,a,i)=>{const l=t===wa.add?a("settings.link_rule.add"):a("settings.link_rule.edit"),s=[];if(!e.rule.includes("{{path}}"))return u.error(a("settings.link_rule.error_msg_2",{action:l,path:"{{path}}"})),void i(!1);if(e.rule.includes("{{owner}}")||s.push("{{owner}}"),e.rule.includes("{{repo}}")||s.push("{{repo}}"),e.rule.includes("{{branch}}")||s.push("{{branch}}"),s.length){const e=a("settings.link_rule.error_msg_3",{action:l,rules:s.join("、")});f.confirm(e,`${l}`,{type:"warning",showClose:t===wa.add,showCancelButton:t===wa.add}).then((()=>{i(!0)})).catch((()=>{i(!1)}))}else i(!0)},Ta={imageName:{autoAddHash:!0,autoTimestampNaming:!1,prefixNaming:{enable:!1,prefix:""}},compress:{enable:!0,encoder:dt.webP},theme:{mode:It.system},elementPlusSize:vt.default,imageLinkType:{selected:mt.jsDelivr,presetList:{[`${mt.GitHubPages}`]:{id:At(),name:mt.GitHubPages,rule:"https://{{owner}}.github.io/{{repo}}/{{path}}"},[`${mt.GitHub}`]:{id:At(),name:mt.GitHub,rule:"https://github.com/{{owner}}/{{repo}}/raw/{{branch}}/{{path}}"},[`${mt.jsDelivr}`]:{id:At(),name:mt.jsDelivr,rule:"https://cdn.jsdelivr.net/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},[`${mt.Statically}`]:{id:At(),name:mt.Statically,rule:"https://cdn.statically.io/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},[`${mt.ChinaJsDelivr}`]:{id:At(),name:mt.ChinaJsDelivr,rule:"https://jsd.cdn.zzko.cn/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"}}},imageLinkFormat:{enable:!1,selected:"Markdown",presetList:[{name:"Markdown",format:"![imageName](imageLink)"},{name:"HTML",format:'<img src="imageLink" alt="imageName" />'},{name:"BBCode",format:"[img]imageLink[/img]"}]},starred:!1,watermark:{enable:!1,text:"PicX",fontSize:50,position:yt.rightBottom,textColor:"#FFFFFF",opacity:.5},deploy:{github:{uuid:At(),status:null,latestTime:null,type:ka.githubPages}},language:xt.zhCN},Oa=v({modules:{dirImageListModule:st,userConfigInfoModule:va,imageCardModule:ba,uploadAreaActiveModule:ya,userSettingsModule:{state:{userSettings:(()=>{const e=jt("PICX_SETTINGS");return e&&Nt(Ta,e),Ta})()},actions:{SET_USER_SETTINGS({state:e,dispatch:t},a){for(const i in a)e.userSettings.hasOwnProperty(i)&&(e.userSettings[i]=a[i]);t("USER_SETTINGS_PERSIST")},ADD_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},{rule:a,$t:i}){const l=e.userSettings.imageLinkType.presetList;Object.hasOwn(l,a.name)?u.error(i("settings.link_rule.error_msg_1")):Sa(a,wa.add,i,(i=>{i&&(e.userSettings.imageLinkType.presetList[a.name]=a,t("USER_SETTINGS_PERSIST"))}))},UPDATE_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},{rule:a,$t:i}){Sa(a,wa.edit,i,(i=>{i&&(e.userSettings.imageLinkType.presetList[a.name].rule=a.rule,t("USER_SETTINGS_PERSIST"))}))},DEL_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},a){delete e.userSettings.imageLinkType.presetList[a.name],t("USER_SETTINGS_PERSIST")},USER_SETTINGS_PERSIST({state:e}){localStorage.setItem("PICX_SETTINGS",JSON.stringify(e.userSettings))},USER_SETTINGS_LOGOUT({state:e}){e.userSettings=Ta}},getters:{getUserSettings:e=>e.userSettings}},toolboxImageListModule:{state:{toolboxImageList:[]},mutations:{},actions:{TOOLBOX_IMG_LIST_ADD({state:e},t){e.toolboxImageList.unshift(t)},TOOLBOX_IMG_LIST_REMOVE({state:e},t){if(e.toolboxImageList.length>0){const a=e.toolboxImageList.findIndex((e=>e.uuid===t));-1!==a&&e.toolboxImageList.splice(a,1)}},TOOLBOX_IMG_LIST_RESET({state:e}){e.toolboxImageList=[]}},getters:{getToolboxImageList:e=>e.toolboxImageList}},uploadImageListModule:{state:{uploadImageList:[]},mutations:{},actions:{UPLOAD_IMG_LIST_ADD({state:e},t){e.uploadImageList.unshift(t)},UPLOAD_IMG_LIST_REMOVE({state:e},t){if(e.uploadImageList.length>0){const a=e.uploadImageList.findIndex((e=>e.uuid===t));-1!==a&&0===e.uploadImageList[a].uploadStatus.progress&&e.uploadImageList.splice(a,1)}},UPLOAD_IMG_LIST_RESET({state:e}){e.uploadImageList=[]}},getters:{getUploadImageList:e=>e.uploadImageList}},githubAuthorizeModule:{state:{authorizationInfo:(()=>{const e={authorized:!1,installed:!1,token:"",tokenCreateTime:0,code:"",codeCreateTime:0,installationId:"",manualToken:"",isAutoAuthorize:!1},t=jt("PICX_AUTHORIZATION");return t?(Nt(e,t),e):e})()},actions:{SET_GITHUB_AUTHORIZATION_INFO({state:e,dispatch:t},a){for(const i in a)Object.hasOwn(e.authorizationInfo,i)&&(e.authorizationInfo[i]=a[i]);t("GITHUB_AUTHORIZATION_INFO_PERSIST")},GITHUB_AUTHORIZATION_INFO_PERSIST({state:e}){var t,a;t="PICX_AUTHORIZATION",a=e.authorizationInfo,localStorage.setItem(t,JSON.stringify(a))}},getters:{getGitHubAuthorizationInfo:e=>e.authorizationInfo}}},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:t}){t("UPLOAD_AREA_ACTIVE_LOGOUT"),e("DIR_IMAGE_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),e("USER_SETTINGS_LOGOUT"),e("TOOLBOX_IMG_LIST_RESET"),e("UPLOAD_IMG_LIST_RESET"),localStorage.clear(),sessionStorage.clear()}},getters:{}}),La=Symbol("vuex-store");function Ca(){return b(La)}const $a=()=>{const{tokenCreateTime:e}=y((()=>Oa.getters.getGitHubAuthorizationInfo)).value;return Date.now()-e>288e5},Ea=()=>{window.location.href="https://github.com/login/oauth/authorize?client_id=Iv1.274fe6f96551b91f&redirect_uri=https://picx.xpoet.cn"};var Da,Aa;(Aa=Da||(Da={}))[Aa.installGitHubAppURL=0]="installGitHubAppURL",Aa[Aa.oauthLoginDocs=1]="oauthLoginDocs",Aa[Aa.generateTokenURL=2]="generateTokenURL",Aa[Aa.tokenLoginDocs=3]="tokenLoginDocs";var Ra=(e,t)=>{const a=e.__vccOpts||e;for(const[i,l]of t)a[i]=l;return a};const Pa={class:"page-container login-container"},Na={class:"left-box box-item"},Ua={class:"tips-box"},za={class:"tip-item"},Ga={class:"right-box box-item"},Ma={class:"tips-box"},ja={class:"tip-item"};var Ha=Ra(w({__name:"picx-login",setup(e){const t=y((()=>Oa.getters.getGitHubAuthorizationInfo)).value,a=y((()=>Oa.getters.getUserConfigInfo)).value,i=I(!1),l=()=>{i.value=!0,Oa.dispatch("SET_GITHUB_AUTHORIZATION_INFO",{isAutoAuthorize:!0});const{authorized:e,installed:a,token:l}=t;e&&a&&l&&!$a()?(Oa.dispatch("SET_USER_CONFIG_INFO",{token:l}),Xn.push("/config")):Ea()},s=()=>{const{manualToken:e}=t;Oa.dispatch("SET_GITHUB_AUTHORIZATION_INFO",{isAutoAuthorize:!1}),Oa.dispatch("SET_USER_CONFIG_INFO",{token:e}),Xn.push({path:"/config",query:{focus:"1"}})},c=e=>{let t="https://picx-docs.xpoet.cn";switch(e){case Da.installGitHubAppURL:t="https://github.com/apps/picx-app/installations/select_target",a.id&&(t="https://github.com/apps/picx-app/installations/new/permissions?target_id="+a.id),window.location.href=t;break;case Da.oauthLoginDocs:window.open(`${t}/docs/usage-guide/config.html#github-oauth-授权登录`);break;case Da.generateTokenURL:window.open("https://github.com/settings/tokens/new");break;case Da.tokenLoginDocs:window.open(`${t}/docs/usage-guide/config.html#填写-github-token-登录`);break;default:window.open(t)}};return k((()=>{(async()=>{var e;const t=new URLSearchParams(window.location.search),a=t.get("code"),i=t.get("setup_action"),l=t.get("installation_id");if("install"===i&&l&&!a&&(await Oa.dispatch("SET_GITHUB_AUTHORIZATION_INFO",{installed:!0,installationId:l}),f.confirm(Et.global.t("authorization.msg_3"),Et.global.t("tips"),{confirmButtonText:Et.global.t("confirm"),cancelButtonText:Et.global.t("cancel"),type:"success",draggable:!0}).then((()=>{Ea()})).catch((()=>{window.location.href="/"}))),a){const t=m.service({lock:!0,text:Et.global.t("authorization.loading_1")});try{await Oa.dispatch("SET_GITHUB_AUTHORIZATION_INFO",{authorized:!0,code:a,codeCreateTime:Date.now(),isAutoAuthorize:!0});const{token:i}=y((()=>Oa.getters.getGitHubAuthorizationInfo)).value;let l="";if(!i||i&&$a()){const t=await d.get(`https://apis.xpoet.cn/api/github-authorize?code=${a}&redirect_uri=https://picx.xpoet.cn`);(null==(e=t.data)?void 0:e.data)?(l=t.data.data,await Oa.dispatch("SET_GITHUB_AUTHORIZATION_INFO",{token:l,tokenCreateTime:Date.now()})):u.error({message:t.data.msg,duration:6e3})}else l=i;if(l){await Oa.dispatch("SET_USER_CONFIG_INFO",{token:l}),t.close();const e=window.location.href.replace(window.location.search,"");window.location.href=`${e}config?auto=1`}t.close()}catch(s){t.close(),u.error({message:Et.global.t("authorization.msg_4"),duration:6e3})}}})(),(()=>{var e;const{token:t,name:i,owner:l,selectedRepo:s,selectedBranch:n,selectedDir:o,logined:r}=a;"0"!==(null==(e=Xn.currentRoute.value.query)?void 0:e.jump)&&t&&i&&l&&r&&(s&&n&&o?Xn.push("/upload"):Xn.push("/config"))})()})),(e,a)=>{const d=x,u=Je,m=S,g=Xe,p=Be;return n(),o("div",Pa,[r("div",Na,[T(d,{plain:"",type:"primary",onClick:l,size:"large",loading:i.value},{default:O((()=>[$(L(e.$t("authorization.text_1")),1)])),_:1},8,["loading"]),r("div",Ua,[r("div",za,L(e.$t("authorization.text_8")),1),r("div",{class:"tip-item link",onClick:a[0]||(a[0]=e=>c(C(Da).oauthLoginDocs))},[T(m,null,{default:O((()=>[T(u)])),_:1}),$(" "+L(e.$t("authorization.text_10")),1)]),r("div",{class:"tip-item link",onClick:a[1]||(a[1]=e=>c(C(Da).installGitHubAppURL))},[T(m,null,{default:O((()=>[T(g)])),_:1}),$(" "+L(e.$t("authorization.text_11"))+" ",1),C(t).installed?(n(),E(m,{key:0,class:"install-status"},{default:O((()=>[T(p)])),_:1})):D("",!0)])])]),r("div",Ga,[T(d,{plain:"",type:"primary",size:"large",onClick:s},{default:O((()=>[$(L(e.$t("authorization.text_2")),1)])),_:1}),r("div",Ma,[r("div",ja,L(e.$t("authorization.text_9")),1),r("div",{class:"tip-item link",onClick:a[2]||(a[2]=e=>c(C(Da).tokenLoginDocs))},[T(m,null,{default:O((()=>[T(u)])),_:1}),$(" "+L(e.$t("authorization.text_10")),1)]),r("div",{class:"tip-item link",onClick:a[3]||(a[3]=e=>c(C(Da).generateTokenURL))},[T(m,null,{default:O((()=>[T(g)])),_:1}),$(" "+L(e.$t("authorization.text_12")),1)])])])])}}}),[["__scopeId","data-v-6fb8b110"]]);const Ba=e=>{switch(e){case ka.githubPages:return"GitHub Pages";case ka.vervel:return"Vercel";default:return"GitHub Pages"}},Va=y((()=>Oa.getters.getUserSettings)).value,Fa=y((()=>Oa.getters.getUserConfigInfo)).value,Xa=async()=>{const{owner:e,selectedRepo:t,selectedBranch:a}=Fa,i=await Vt({url:`/repos/${e}/${t}/contents/.deploy`,method:"GET",noShowErrorMsg:!0,cache:{maxAge:0},params:{branch:a,timestamp:Date.now()}});return Promise.resolve(i)};const Wa={class:"deploy-box border-box"},qa={class:"left-wrap"},Ja={key:0,class:"deploy-datetime info-item"},Ka={class:"deploy-server info-item"},Za={class:"deploy-status info-item"},Ya={class:"right-wrap"};var Qa=Ra(w({__name:"deploy-bar",props:{disabled:{type:Boolean,default:!1}},setup(e){const t=y((()=>Oa.getters.getUserSettings)).value,a=y((()=>Oa.getters.getUserConfigInfo)).value,i=e=>{switch(e.type){case ka.githubPages:return void(async(e,t)=>{var a;const{owner:i,selectedRepo:l,selectedBranch:s}=e,n=m.service({text:Et.global.t("settings.image_hosting_deploy.deploying")}),o=(e=!1)=>{t&&t(e),n.close()};try{const e=(await qt(i,l)).some((e=>"gh-pages"===e.value));let t=!0;if(e){if(t=!1,!(await Bt.delete(`/repos/${i}/${l}/git/refs/heads/gh-pages`)))return void o(!1);t=!0}if(t){let e="";const t=await Vt({url:`/repos/${i}/${l}/git/refs/heads/${s}`,method:"GET"});if(t&&(e=null==(a=null==t?void 0:t.object)?void 0:a.sha),!e)return void o(!1);(await Vt({url:`/repos/${i}/${l}/git/refs`,method:"POST",params:{ref:"refs/heads/gh-pages",sha:e}})).object.sha?setTimeout((()=>{o(!0)}),5e4):o(!1)}}catch(r){console.error(r),o(!1)}})(a,(e=>{t.deploy.github.status=e,t.deploy.github.latestTime=Date.now(),(async()=>{const{owner:e,selectedRepo:t,selectedBranch:a}=Fa,i=await Xa(),l={message:i?"Update deploy status via PicX (https://github.com/XPoet/picx)":"Init deploy status via PicX (https://github.com/XPoet/picx)",content:window.btoa(JSON.stringify(Va.deploy))};i?l.sha=i.sha:l.branch=a;const s=await Vt({url:`/repos/${e}/${t}/contents/.deploy`,method:"PUT",data:l,noShowErrorMsg:!0});Promise.resolve(s)})(),e?(t.imageLinkType.selected=mt.GitHubPages,Oa.dispatch("USER_SETTINGS_PERSIST"),u.success(Et.global.t("settings.image_hosting_deploy.success"))):u.error(Et.global.t("settings.image_hosting_deploy.fail2"))}));case ka.vervel:}};return(a,l)=>{const s=x,c=A;return n(),o("div",Wa,[(n(!0),o(R,null,P(C(t).deploy,((t,l)=>(n(),o("div",{class:"deploy-item border-box",key:l+t.uuid},[r("div",qa,[r("span",{class:N(["deploy-status-icon info-item",{success:!0===t.status,fail:!1===t.status}])},null,2),t.latestTime?(n(),o("span",Ja,L(C(Ut)("yyyy-MM-dd hh:mm:ss",t.latestTime)),1)):D("",!0),r("span",Ka,L(C(Ba)(t.type)),1),r("span",Za,L(null===t.status?a.$t("settings.image_hosting_deploy.not_deployed"):!0===t.status?a.$t("settings.image_hosting_deploy.success"):a.$t("settings.image_hosting_deploy.fail")),1)]),r("div",Ya,[T(c,{placement:"top",content:a.$t("settings.image_hosting_deploy.deploy_to",{server:C(Ba)(t.type)})},{default:O((()=>[T(s,{type:"primary",disabled:e.disabled,text:"",onClick:e=>i(t)},{default:O((()=>[$(L(a.$t("settings.image_hosting_deploy.one_click_deploy")),1)])),_:2},1032,["disabled","onClick"])])),_:2},1032,["content"])])])))),128))])}}}),[["__scopeId","data-v-34e941fb"]]);const ei=w({__name:"repo-dir-cascader",props:{elKey:{type:String,default:""},elSize:{type:String,default:vt.default},elWidth:{type:String,default:"100%"},elClearable:{type:Boolean,default:!1}},setup(e){const t=Ca(),a=y((()=>t.getters.getUserConfigInfo)).value,i={lazy:!0,checkStrictly:!0,async lazyLoad(e,t){const{level:i,pathLabels:l}=e;let s;s=0===i?a.dirList:await Ft(a,l.join("/")),t(s?s.map((e=>({value:e.value,label:e.label,leaf:i>=4}))):[])}},l=e=>{a.selectedDirList=e,a.selectedDir=e.join("/"),t.dispatch("USER_CONFIG_INFO_PERSIST")};return(t,s)=>{const o=U;return n(),E(o,{style:z({width:e.elWidth}),size:e.elSize,debounce:500,props:i,key:e.elKey,modelValue:C(a).selectedDirList,"onUpdate:modelValue":s[0]||(s[0]=e=>C(a).selectedDirList=e),filterable:"",placeholder:t.$t("config.placeholder5"),clearable:e.elClearable,onChange:l},null,8,["style","size","modelValue","placeholder","clearable"])}}});const ti={key:0,class:"selected-info-bar-box"},ai={class:"info-item repo"},ii={key:0,class:"info-item branch"},li={class:"info-item dir"};var si=Ra(w({__name:"selected-info-bar",props:{barType:{type:String,default:"upload"}},setup(e){const t=Ca(),a=y((()=>t.getters.getUserConfigInfo)),i=y((()=>t.getters.getUserSettings));return(t,l)=>{const s=G,c=ei;return a.value.selectedRepo?(n(),o("div",ti,[r("span",ai,[$(L(t.$t("repo"))+"： ",1),T(s,{"disable-transitions":""},{default:O((()=>[$(L(a.value.selectedRepo),1)])),_:1})]),a.value.selectedBranch?(n(),o("span",ii,[$(L(t.$t("branch"))+"： ",1),T(s,{"disable-transitions":""},{default:O((()=>[$(L(a.value.selectedBranch),1)])),_:1})])):D("",!0),r("span",li,[$(L(t.$t("dir"))+"： ",1),a.value.dirMode!==C(_t).repoDir||"management"===e.barType?(n(),E(s,{key:0,"disable-transitions":""},{default:O((()=>[$(L("management"===e.barType?a.value.viewDir:a.value.selectedDir),1)])),_:1})):D("",!0),a.value.dirMode===C(_t).repoDir&&"upload"===e.barType?(n(),E(c,{key:1,"el-size":i.value.elementPlusSize===C(vt).large?C(vt).default:i.value.elementPlusSize,"el-width":"","el-clearable":!1},null,8,["el-size"])):D("",!0)])])):D("",!0)}}}),[["__scopeId","data-v-02ac177a"]]);const ni={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},oi=[r("path",{fill:"currentColor",d:"M544 864V672h128L512 480L352 672h128v192H320v-1.6c-5.376.32-10.496 1.6-16 1.6A240 240 0 0 1 64 624c0-123.136 93.12-223.488 212.608-237.248A239.81 239.81 0 0 1 512 192a239.87 239.87 0 0 1 235.456 194.752c119.488 13.76 212.48 114.112 212.48 237.248a240 240 0 0 1-240 240c-5.376 0-10.56-1.28-16-1.6v1.6z"},null,-1)];var ri={name:"ep-upload-filled",render:function(e,t){return n(),o("svg",ni,[...oi])}};const ci=(e=>(H("data-v-7144607c"),e=e(),B(),e))((()=>r("label",{for:"input-file-selector"},null,-1))),di={key:0,class:"upload-area-tips"},ui={class:"text"},mi=["src"];var gi=Ra(w({__name:"getting-images",props:{disabled:{type:Boolean,default:!1}},emits:["getImgList"],setup(e,{expose:t,emit:a}){const i=Ca(),l=y((()=>i.getters.getUploadAreaActive)),s=I({uuid:"",base64:""}),c=I([]),d=a,u=()=>{const e=c.value.length,t=e>0?c.value[e-1]:{uuid:"",base64:""};s.value={uuid:t.uuid,base64:t.base64}},m=async e=>{if(e.length){c.value=[];for(const t of e){const e=await ca(t);e&&c.value.push(e)}u(),i.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0),d("getImgList",c.value)}},g=async e=>{const t=e.target;await m(t.files),t.value="",t.value=t.defaultValue},p=async e=>{await m(e.dataTransfer.files)},h=async e=>{const t=Array.from(e.clipboardData.items).filter((e=>"file"===e.kind&&oa(e.type))).map((e=>e.getAsFile()));await m(t)};return k((()=>{window.addEventListener("paste",h)})),M((()=>{window.removeEventListener("paste",h)})),t({reset:()=>{c.value=[],s.value.uuid="",s.value.base64=""},remove:e=>{const t=c.value.findIndex((t=>t.uuid===e));-1!==t&&c.value.splice(t,1),e===s.value.uuid&&u()}}),(t,a)=>{const i=ri,c=S;return n(),o("div",{class:N(["getting-images-container",{focus:l.value&&s.value.base64,disabled:e.disabled}]),onDragover:a[0]||(a[0]=j((()=>{}),["prevent"])),onDrop:j(p,["stop","prevent"]),onPaste:j(h,["stop"])},[ci,r("input",{id:"input-file-selector",type:"file",accept:"image/*",onChange:g,multiple:"multiple"},null,32),s.value.base64?D("",!0):(n(),o("div",di,[T(c,{class:"icon"},{default:O((()=>[T(i)])),_:1}),r("div",ui,L(t.$t("upload.uploadAreaTips")),1)])),s.value.base64?(n(),o("img",{key:1,class:"preview-img",src:s.value.base64},null,8,mi)):D("",!0)],34)}}}),[["__scopeId","data-v-7144607c"]]);const pi=y((()=>Oa.getters.getUserSettings)).value,hi=(e,t,a)=>{var i;let l=a.selectedDir;(null==(i=null==t?void 0:t.reUploadInfo)?void 0:i.isReUpload)&&(l=t.reUploadInfo.dir),t.uploadStatus.progress=100,t.uploadStatus.uploading=!1;const s={checked:!1,type:"image",uuid:t.uuid,dir:l,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size};t.uploadedImg=s,Oa.dispatch("DIR_IMAGE_LIST_ADD_DIR",l),Oa.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",s)};function _i(e,t){const{selectedBranch:a,email:i,owner:l}=e,s={message:"Upload image via PicX (https://github.com/XPoet/picx)",branch:a,content:(t.base64.compressBase64||t.base64.watermarkBase64||t.base64.originalBase64).split(",")[1]};return i&&(s.committer={name:l,email:i}),t.uploadStatus.uploading=!0,new Promise((async a=>{const i=await((e,t)=>Vt({url:e,method:"PUT",data:t}))(((e,t)=>{var a;const{owner:i,selectedRepo:l,selectedDir:s}=e,n=t.filename.final;let o=n;return"/"!==s&&(o=`${s}/${n}`),(null==(a=null==t?void 0:t.reUploadInfo)?void 0:a.isReUpload)&&(o=t.reUploadInfo.path),`/repos/${i}/${l}/contents/${o}`})(e,t),s);if(t.uploadStatus.uploading=!1,i){const{name:l,sha:s,path:n,size:o}=i.content;hi({name:l,sha:s,path:n,size:o},t,e),a(!0)}else a(!1)}))}const fi={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},vi=[r("path",{fill:"currentColor",d:"M406.656 706.944L195.84 496.256a32 32 0 1 0-45.248 45.248l256 256l512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1)];var bi={name:"ep-check",render:function(e,t){return n(),o("svg",fi,[...vi])}};const yi={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},wi=[r("path",{fill:"currentColor",d:"M160 832h704a32 32 0 1 1 0 64H160a32 32 0 1 1 0-64m384-578.304V704h-64V247.296L237.248 490.048L192 444.8L508.8 128l316.8 316.8l-45.312 45.248z"},null,-1)];var Ii={name:"ep-upload",render:function(e,t){return n(),o("svg",yi,[...wi])}};const ki={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},xi=[r("path",{fill:"currentColor",d:"M352 480h320a32 32 0 1 1 0 64H352a32 32 0 0 1 0-64"},null,-1),r("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768a384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896a448 448 0 0 1 0 896"},null,-1)];var Si={name:"ep-remove",render:function(e,t){return n(),o("svg",ki,[...xi])}};const Ti={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Oi=[r("path",{fill:"currentColor",d:"M672 192L288 511.936L672 832z"},null,-1)];var Li={name:"ep-caret-left",render:function(e,t){return n(),o("svg",Ti,[...Oi])}};const Ci={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},$i=[r("path",{fill:"currentColor",d:"m192 384l320 384l320-384z"},null,-1)];var Ei={name:"ep-caret-bottom",render:function(e,t){return n(),o("svg",Ci,[...$i])}};const Di=(e,t)=>{t.filename.isPrefixNaming=e,t.filename.name=e?`${t.filename.prefixName}${t.filename.initName}`:`${t.filename.initName}`,t.filename.isAddHash?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},Ai=(e,t)=>{t.filename.isAddHash=e,t.filename.final=e?`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:`${t.filename.name}.${t.filename.suffix}`};const Ri=["element-loading-text"],Pi={class:"before-upload-handle-container"},Ni={class:"img-name text-ellipsis"},Ui={class:"operate-item"},zi={class:"operate-item"},Gi={class:"operate-item"},Mi={key:0,class:"operate-item"},ji={key:1,class:"img-info-box"},Hi={class:"file-size-box"},Bi={key:0,class:"finial-file-size file-size-item"},Vi={class:"last-modified"};var Fi=Ra(w({__name:"upload-image-card",props:{imgObj:{type:Object,require:!0,default:()=>({})}},emits:["remove"],setup(e,{emit:t}){const a=Ca(),i=Z(),l=e,s=t,c=I(null),d=y((()=>a.getters.getUserSettings)).value,u=y((()=>a.getters.getUserConfigInfo)).value,m=I(""),g=V({isHash:!1,isPrefixNaming:!1,isTimestampNaming:!1,isRename:!1,newName:""}),p=I(!0),h=()=>{var e,t;l.imgObj.filename.newName=g.newName,setTimeout((()=>{var e;null==(e=c.value)||e.focus()}),100),e=g.isRename,(t=l.imgObj).filename.isRename=e,e?t.filename.name=t.filename.newName.trim().replace(/\s+/g,"-"):Di(t.filename.isPrefixNaming,t),t.filename.isAddHash?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},_=e=>{const{suffix:t,isPrefixNaming:a,isAddHash:i}=l.imgObj.filename;e?(g.isHash=!1,g.isPrefixNaming=!1,l.imgObj.filename.final=`${Date.now()}.${t}`):(Di(a,l.imgObj),Ai(i,l.imgObj),g.isHash=i,g.isPrefixNaming=a)};return F((()=>l.imgObj.uploadStatus),(e=>{e.uploading&&(m.value=i.proxy.$t("upload.loading1"))}),{deep:!0,immediate:!0}),k((async()=>{await(async(e,t)=>{const{watermark:a,compress:i}=t;let l=e.fileInfo.originalFile;var s;a.enable&&a.text&&!e.fileInfo.watermarkFile&&(e.beforeUploadStatus.watermarking=!0,e.fileInfo.watermarkFile=(s=e.fileInfo.originalFile.type,/(png|jpg|jpeg|webp|avif)$/.test(s)?await Mt(e.fileInfo.originalFile,a):e.fileInfo.originalFile),l=e.fileInfo.watermarkFile,e.base64.watermarkBase64=await ia(l),e.beforeUploadStatus.watermarking=!1),i.enable&&!e.fileInfo.compressFile&&(e.beforeUploadStatus.compressing=!0,e.fileInfo.compressFile=await da(l,i.encoder),l=e.fileInfo.compressFile,e.base64.compressBase64=await ia(l),e.filename.suffix=na(l.name),e.beforeUploadStatus.compressing=!1)})(l.imgObj,d),(()=>{const{imageName:e}=d;0===l.imgObj.uploadStatus.progress&&(l.imgObj.filename.isTimestampNaming=e.autoTimestampNaming,l.imgObj.filename.isTimestampNaming?(l.imgObj.filename.isAddHash=!1,l.imgObj.filename.isPrefixNaming=!1,_(!0)):(l.imgObj.filename.isAddHash=e.autoAddHash,l.imgObj.filename.isPrefixNaming=e.prefixNaming.enable,l.imgObj.filename.prefixName=e.prefixNaming.prefix,Di(e.prefixNaming.enable,l.imgObj),Ai(e.autoAddHash,l.imgObj)),g.isTimestampNaming=l.imgObj.filename.isTimestampNaming,g.isHash=l.imgObj.filename.isAddHash,g.isPrefixNaming=l.imgObj.filename.isPrefixNaming,g.isRename=l.imgObj.filename.isRename,g.newName=l.imgObj.filename.newName)})()})),(t,a)=>{var i,f,v,b,y,w,I,k;const x=X,$=Ei,R=Li,P=S,U=A,z=W,G=q,M=Si,j=Ii,H=bi,B=J;return n(),o("div",{class:N(["upload-image-card-container",{"wait-upload":!e.imgObj.uploadStatus.uploading&&0===e.imgObj.uploadStatus.progress,uploading:e.imgObj.uploadStatus.uploading&&100!==e.imgObj.uploadStatus.progress,uploaded:!e.imgObj.uploadStatus.uploading&&100===e.imgObj.uploadStatus.progress}])},[K((n(),o("div",{class:"img-show-container","element-loading-text":m.value},[T(x,{src:e.imgObj.base64.compressBase64||e.imgObj.base64.watermarkBase64||e.imgObj.base64.originalBase64,fit:"cover",loading:"lazy","hide-on-click-modal":!0,"preview-src-list":[e.imgObj.base64.compressBase64||e.imgObj.base64.watermarkBase64||e.imgObj.base64.originalBase64]},null,8,["src","preview-src-list"])],8,Ri)),[[B,e.imgObj.uploadStatus.uploading||e.imgObj.beforeUploadStatus.compressing||e.imgObj.beforeUploadStatus.watermarking]]),r("div",Pi,[r("div",{class:N(["img-name-box",{"no-border":100===e.imgObj.uploadStatus.progress}])},[r("span",Ni,L(e.imgObj.filename.final||e.imgObj.filename.name),1),0===e.imgObj.uploadStatus.progress?(n(),E(U,{key:0,placement:"top",offset:8,content:p.value?t.$t("upload.expand"):t.$t("upload.fold")},{default:O((()=>[T(P,{class:"fold-btn",onClick:a[0]||(a[0]=e=>p.value=!p.value)},{default:O((()=>[p.value?D("",!0):(n(),E($,{key:0})),p.value?(n(),E(R,{key:1})):D("",!0)])),_:1})])),_:1},8,["content"])):D("",!0)],2),0===e.imgObj.uploadStatus.progress?(n(),o("div",{key:0,class:N(["img-name-operate-box",{folded:p.value}])},[r("div",Ui,[T(z,{label:t.$t("upload.hash"),modelValue:g.isHash,"onUpdate:modelValue":a[1]||(a[1]=e=>g.isHash=e),onChange:a[2]||(a[2]=e=>{return t=e,g.isTimestampNaming=!1,void Ai(t,l.imgObj);var t})},null,8,["label","modelValue"])]),r("div",zi,[T(z,{label:t.$t("upload.rename"),modelValue:g.isRename,"onUpdate:modelValue":a[3]||(a[3]=e=>g.isRename=e),onChange:h},null,8,["label","modelValue"]),e.imgObj.filename.isRename?(n(),E(G,{key:0,class:"rename-input",size:"small",modelValue:g.newName,"onUpdate:modelValue":a[4]||(a[4]=e=>g.newName=e),onInput:h,maxlength:C(18),ref_key:"renameInputRef",ref:c,clearable:""},null,8,["modelValue","maxlength"])):D("",!0)]),r("div",Gi,[T(z,{label:t.$t("upload.timestamp-naming"),modelValue:g.isTimestampNaming,"onUpdate:modelValue":a[5]||(a[5]=e=>g.isTimestampNaming=e),onChange:_},null,8,["label","modelValue"])]),!e.imgObj.filename.isRename&&C(d).imageName.prefixNaming.enable&&C(d).imageName.prefixNaming.prefix?(n(),o("div",Mi,[T(z,{label:t.$t("upload.prefixNaming"),modelValue:g.isPrefixNaming,"onUpdate:modelValue":a[6]||(a[6]=e=>g.isPrefixNaming=e),onChange:a[7]||(a[7]=e=>{return t=e,g.isTimestampNaming=!1,void Di(t,l.imgObj);var t})},null,8,["label","modelValue"])])):D("",!0)],2)):D("",!0),0===e.imgObj.uploadStatus.progress?(n(),o("div",ji,[r("div",Hi,[r("span",{class:N(["original-file-size file-size-item",{"del-line":null==(f=null==(i=e.imgObj.fileInfo)?void 0:i.compressFile)?void 0:f.size}])},L(C(ra)(null==(v=e.imgObj.fileInfo.originalFile)?void 0:v.size))+" KB ",3),(null==(y=null==(b=e.imgObj.fileInfo)?void 0:b.compressFile)?void 0:y.size)?(n(),o("span",Bi,L(C(ra)(null==(I=null==(w=e.imgObj.fileInfo)?void 0:w.compressFile)?void 0:I.size))+" KB ",1)):D("",!0)]),r("span",Vi,L(C(Ut)("yyyy-MM-dd hh:mm",null==(k=e.imgObj.fileInfo.originalFile)?void 0:k.lastModified)),1)])):D("",!0)]),100===e.imgObj.uploadStatus.progress?(n(),o("div",{key:0,class:"after-upload-handle-container flex-center",onClick:a[8]||(a[8]=t=>C(pa)(e.imgObj.uploadedImg,C(u),C(d)))},L(t.$t("upload.copyLink")),1)):D("",!0),0===e.imgObj.uploadStatus.progress?(n(),E(U,{key:1,placement:"top",offset:8,content:t.$t("upload.delete")},{default:O((()=>[T(P,{class:"del-img-btn",onClick:a[9]||(a[9]=t=>{return a=e.imgObj.uuid,void s("remove",a);var a})},{default:O((()=>[T(M)])),_:1})])),_:1},8,["content"])):D("",!0),r("div",{class:N(["upload-status-box",{"wait-upload":!e.imgObj.uploadStatus.uploading&&0===e.imgObj.uploadStatus.progress,uploaded:!e.imgObj.uploadStatus.uploading&&100===e.imgObj.uploadStatus.progress}])},[T(P,null,{default:O((()=>[e.imgObj.uploadStatus.uploading||0!==e.imgObj.uploadStatus.progress?D("",!0):(n(),E(j,{key:0})),e.imgObj.uploadStatus.uploading||100!==e.imgObj.uploadStatus.progress?D("",!0):(n(),E(H,{key:1}))])),_:1})],2)],2)}}}),[["__scopeId","data-v-5045012e"]]);const Xi={class:"upload-page-container"},Wi={key:0,class:"upload-page-left page-container",style:{width:"300rem"}},qi={class:"row-item"},Ji={class:"content-box"},Ki={class:"row-item"},Zi={class:"content-box upload-area-status"},Yi={key:0},Qi={key:0,class:"row-item"},el={class:"content-box"},tl={key:1,class:"row-item"},al={class:"content-box operation-btn"},il={class:"shortcut-key"},ll={class:"shortcut-key"},sl=w({__name:"upload-image",setup(e){const t=Ca(),a=Y(),i=Z(),l=I(null),c=y((()=>t.getters.getUserConfigInfo)).value,d=y((()=>t.getters.getUserSettings)).value,m=y((()=>t.getters.getUserLoginStatus)),g=I([]),p=I(!1),h=y((()=>"mac"===_a()?"Command":"Ctrl")),_=I(!1),f=e=>{e.forEach((e=>{t.dispatch("UPLOAD_IMG_LIST_ADD",(e=>{const t={uuid:"",base64:{originalBase64:"",watermarkBase64:null,compressBase64:null},fileInfo:{originalFile:null,watermarkFile:null,compressFile:null},filename:{hash:"",suffix:"",name:"",prefixName:"",final:"",initName:"",newName:"",isAddHash:!0,isRename:!1,isPrefixNaming:!1,isTimestampNaming:!1},beforeUploadStatus:{watermarking:!1,compressing:!1},uploadStatus:{progress:0,uploading:!1},reUploadInfo:{dir:"",path:"",isReUpload:!1}};t.uuid=e.uuid,t.base64.originalBase64=e.base64,t.fileInfo.originalFile=e.file;const{imageName:a}=pi,i=e.uuid,l=e.file.name.trim().replaceAll(" ","-"),s=l.lastIndexOf("."),n=l.slice(0,s),o=l.slice(s+1);return t.filename.initName=n,t.filename.name=a.prefixNaming.enable?`${a.prefixNaming.prefix}${n}`:n,t.filename.prefixName=a.prefixNaming.prefix,t.filename.hash=i,t.filename.suffix=o,t.filename.final=a.autoAddHash?`${t.filename.name}.${i}.${o}`:`${t.filename.name}.${o}`,t.filename.isAddHash=a.autoAddHash,t.filename.isPrefixNaming=a.prefixNaming.enable,t.filename.isTimestampNaming=a.autoTimestampNaming,t})(e))}))},v=()=>{var e;null==(e=l.value)||e.reset()},b=async e=>1===e.length?await _i(c,e[0])?nt.uploaded:nt.uploadFail:e.length>1?await async function(e,t){const{selectedBranch:a,selectedRepo:i,selectedDir:l,owner:n}=e,o=[];for(const g of t){g.uploadStatus.uploading=!0;const e=await Kt(g,n,i);e?o.push(s({img:g},e)):(g.uploadStatus.uploading=!1,u.error(`${g.filename.final} 上传失败`))}const r=await Wt(n,i,a);if(!r)return Promise.resolve(!1);const c="/"===l?"":`${l}/`,d=await Zt(n,i,o.map((e=>({sha:e.sha,path:`${c}${e.img.filename.final}`}))),r);if(!d)return Promise.resolve(!1);const m=await Yt(n,i,d,r);return m&&await Qt(n,i,a,m.sha)?(o.forEach((t=>{const a=t.img.filename.final;hi({name:a,sha:t.sha,path:`${c}${a}`,size:0},t.img,e)})),Promise.resolve(!0)):Promise.resolve(!1)}(c,e)?nt.allUploaded:nt.uploadFail:void 0,w=async(e,a=!1)=>{v(),a?ha(e,c,d,!0):pa(e[0],c,d,!0),await t.dispatch("SET_USER_CONFIG_INFO",{viewDir:c.selectedDir})},S=async()=>{var e,t,l,s,n,o,r;const{token:d,selectedRepo:m,selectedDir:h}=c;if(!d)return u.error({message:null==(e=null==i?void 0:i.proxy)?void 0:e.$t("upload.message1")}),void(await a.push("/config"));if(!m)return u.error({message:null==(t=null==i?void 0:i.proxy)?void 0:t.$t("upload.message2")}),void(await a.push("/config"));if(!h)return u.error({message:null==(l=null==i?void 0:i.proxy)?void 0:l.$t("upload.message3")}),void(await a.push("/config"));const _=g.value.filter((e=>0===e.uploadStatus.progress));if(0===_.length)return void u.error({message:null==(s=null==i?void 0:i.proxy)?void 0:s.$t("upload.message4")});p.value=!0;const f=await b(_);p.value=!1;const v=_.filter((e=>100===e.uploadStatus.progress)).map((e=>e.uploadedImg));switch(f){case nt.uploaded:u.success({message:null==(n=null==i?void 0:i.proxy)?void 0:n.$t("upload.message5")}),await w(v);break;case nt.allUploaded:u.success({message:null==(o=null==i?void 0:i.proxy)?void 0:o.$t("upload.message6")}),await w(v,!0);break;case nt.uploadFail:u.error({message:null==(r=null==i?void 0:i.proxy)?void 0:r.$t("upload.message7")})}},E=()=>{p.value=!1,_.value=!1,t.dispatch("UPLOAD_IMG_LIST_RESET"),v()};F((()=>m),(e=>{!e&&E()})),F((()=>t.state.uploadImageListModule.uploadImageList),(e=>{g.value=e,_.value=g.value.some((e=>100===e.uploadStatus.progress))}),{immediate:!0,deep:!0});return k((()=>{document.addEventListener("keydown",(e=>{const t=e.keyCode||e.which||e.charCode,a=e.ctrlKey||e.metaKey;a&&65===t&&g.value.length&&(E(),e.preventDefault()),a&&83===t&&(p.value||(S(),e.preventDefault()))}))})),(e,a)=>{const i=gi,s=si,u=Qa,m=x;return n(),o("div",Xi,[!g.value.length||C(d).elementPlusSize!==C(vt).large&&C(d).elementPlusSize!==C(vt).default?D("",!0):(n(),o("div",Wi,[(n(!0),o(R,null,P(g.value,((e,i)=>(n(),o("div",{class:"uploaded-item",key:i+e.uuid},[T(Fi,{"img-obj":e,onRemove:a[0]||(a[0]=e=>{return a=e,t.dispatch("UPLOAD_IMG_LIST_REMOVE",a),void(null==(i=l.value)||i.remove(a));var a,i})},null,8,["img-obj"])])))),128))])),r("div",{class:N(["upload-page-right page-container",{"has-left":g.value.length}])},[r("div",qi,[r("div",Ji,[T(i,{disabled:p.value,ref_key:"gettingImagesRef",ref:l,onGetImgList:f},null,8,["disabled"])])]),r("div",Ki,[r("div",Zi,[T(s),g.value.length?(n(),o("div",Yi,L(e.$t("upload.uploaded"))+"："+L(g.value.filter((e=>100===e.uploadStatus.progress)).length)+" / "+L(g.value.length),1)):D("",!0)])]),C(c).logined?(n(),o("div",Qi,[r("div",el,[T(u,{disabled:!_.value},null,8,["disabled"])])])):D("",!0),g.value.length?(n(),o("div",tl,[r("div",al,[T(m,{disabled:p.value,plain:"",type:"warning",onClick:E},{default:O((()=>[$(L(e.$t("reset"))+" ",1),r("span",il,"[ "+L(h.value)+" + A ]",1)])),_:1},8,["disabled"]),T(m,{disabled:p.value,plain:"",type:"primary",onClick:S},{default:O((()=>[$(L(e.$t("upload.upload"))+" ",1),r("span",ll,"[ "+L(h.value)+" + S ]",1)])),_:1},8,["disabled"])])])):D("",!0)],2)])}}}),nl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ol=[r("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"},null,-1)];var rl={name:"ep-refresh",render:function(e,t){return n(),o("svg",nl,[...ol])}};const cl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},dl=[r("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224a112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224a112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224a112 112 0 0 1 0-224"},null,-1)];var ul={name:"ep-more-filled",render:function(e,t){return n(),o("svg",cl,[...dl])}};const ml={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},gl=[r("path",{fill:"currentColor",d:"M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64z"},null,-1),r("path",{fill:"currentColor",d:"M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64"},null,-1)];var pl={name:"ep-copy-document",render:function(e,t){return n(),o("svg",ml,[...gl])}};const hl={class:"copy-image-link-box border-box"};var _l=Ra(w({__name:"copy-image-link",props:{imgObj:{type:Object,default:()=>{}}},setup(e){const t=e,a=y((()=>Oa.getters.getUserSettings)).value,i=y((()=>Oa.getters.getUserConfigInfo)).value,l=y((()=>a.imageLinkFormat.enable?`${a.imageLinkType.selected} & ${a.imageLinkFormat.selected}`:`${a.imageLinkType.selected}`));let s=I(t.imgObj).value;const r=()=>{pa(s,i,a)};return Q((()=>{s=t.imgObj})),(e,t)=>{const a=pl,i=S,s=x,c=A;return n(),o("div",hl,[T(c,{content:l.value,placement:"top"},{default:O((()=>[T(s,{plain:"",type:"primary",size:"default",onClick:r},{default:O((()=>[T(i,null,{default:O((()=>[T(a)])),_:1}),$(" "+L(e.$t("upload.copyLink")),1)])),_:1})])),_:1},8,["content"])])}}}),[["__scopeId","data-v-51c845f6"]]);const fl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},vl=[r("path",{fill:"currentColor",d:"M764.288 214.592L512 466.88L259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512L214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1)];var bl={name:"ep-close",render:function(e,t){return n(),o("svg",fl,[...vl])}};const yl=["element-loading-text"],wl={class:"image-box"},Il={class:"info-box"},kl={class:"image-info"},xl={key:0,class:"rename-operate"},Sl={key:1,class:"filename"},Tl={class:"copy-link-box border-box"},Ol={class:"operation-box"},Ll={class:"operation-left"},Cl={class:"operation-right"},$l={class:"operation-btn"};var El=Ra(w({__name:"image-card",props:{imageObj:{type:Object,default:()=>({})},isUploaded:{type:Boolean,default:!1}},setup(e){const t=e,a=Z(),i=Ca(),l=ee(),s=y((()=>i.getters.getUserConfigInfo)).value,c=y((()=>i.getters.getUserSettings)).value,d=y((()=>"/management"===l.path)),g=y((()=>ua(t.imageObj,s,c))),p=I(),h=I(""),_=I(!1),v=I(!1),b=I(!1),w=(e,t=!1)=>{t||(e.deleting=!0);const{owner:l,selectedRepo:n}=s,{path:o,sha:r}=e;return new Promise((async s=>{var c,d;await Jt(l,n,o,r)?(t?(_.value=!1,u.success({message:null==(c=null==a?void 0:a.proxy)?void 0:c.$t("management.message4")})):u.success({message:null==(d=null==a?void 0:a.proxy)?void 0:d.$t("management.message5")}),await i.dispatch("DIR_IMAGE_LIST_REMOVE",e),await i.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),s(!0)):s(!1)}))},k=async()=>{var e,l,n,o,r;const{imageObj:d}=t;if(!h.value)return u.error({message:null==(e=null==a?void 0:a.proxy)?void 0:e.$t("management.message1")}),void(null==(l=p.value)||l.focus());if(h.value===sa(d.name))return u.error({message:null==(n=null==a?void 0:a.proxy)?void 0:n.$t("management.message2")}),void(_.value=!1);const v=async()=>{var e,t,l;const n=m.service({lock:!0,text:null==(e=null==a?void 0:a.proxy)?void 0:e.$t("management.loadingTxt2")}),o=na(d.name),r=At(),p=`${h.value}${c.imageName.autoAddHash?`.${r}`:""}.${o}`;let f;var v;if(f=o.includes("svg")?await(v=g.value||"",new Promise((e=>{Vt({baseURL:"",url:v,method:"GET",responseType:"blob"}).then((t=>{if(t){const a=new FileReader;a.onload=()=>{const t=a.result;e(t)},a.onerror=()=>{e(null)},a.readAsDataURL(t)}else e(null)})).catch((()=>{e(null)}))}))):await function(e,t){const a=document.createElement("canvas"),i=a.getContext("2d"),l=new Image;return l.crossOrigin="Anonymous",l.src=e,new Promise((e=>{l.onload=()=>{const{width:s}=l,{height:n}=l;a.width=s,a.height=n,null==i||i.drawImage(l,0,0,s,n);const o=a.toDataURL(`image/${t}`);e(o)}}))}(g.value||"",o),f){const e={uuid:"",base64:{originalBase64:"",watermarkBase64:null,compressBase64:null},fileInfo:{originalFile:null,watermarkFile:null,compressFile:null},filename:{hash:"",suffix:"",name:"",prefixName:"",final:"",initName:"",newName:"",isAddHash:!0,isRename:!1,isPrefixNaming:!1,isTimestampNaming:!1},beforeUploadStatus:{watermarking:!1,compressing:!1},uploadStatus:{progress:0,uploading:!1},reUploadInfo:{dir:"",path:"",isReUpload:!1}};e.uuid=r,e.base64.originalBase64=f,e.filename.final=p,e.reUploadInfo.isReUpload=!0,e.reUploadInfo.dir=d.dir;let l=p;"/"!==d.dir&&(l=`${d.dir}/${p}`),e.reUploadInfo.path=l;await _i(s,e)?(h.value="",await w(d,!0),await i.dispatch("UPLOAD_IMG_LIST_REMOVE",d.uuid)):u.error({message:null==(t=null==a?void 0:a.proxy)?void 0:t.$t("management.message3")})}else u.error({message:null==(l=null==a?void 0:a.proxy)?void 0:l.$t("management.message3")});n.close(),_.value=!1};f.confirm(null==(o=null==a?void 0:a.proxy)?void 0:o.$t("management.renameTips",{name:h.value}),null==(r=null==a?void 0:a.proxy)?void 0:r.$t("tips"),{type:"info"}).then((()=>{v()})).catch((()=>{_.value=!1}))},A=e=>{b.value=e};return(t,l)=>{const s=X,c=q,u=bl,m=x,y=bi,I=te,R=_l,P=S,U=ul,z=ae,G=ie,M=le,H=J;return K((n(),o("div",{class:N(["image-card",{checked:e.imageObj.checked}]),"element-loading-text":t.$t("management.loadingTxt3"),onMouseenter:l[6]||(l[6]=e=>v.value=!0),onMouseleave:l[7]||(l[7]=e=>v.value=!1)},[r("div",wl,[T(s,{src:g.value,fit:"cover",loading:"lazy",lazy:"","hide-on-click-modal":!0,"preview-src-list":[g.value]},null,8,["src","preview-src-list"])]),r("div",Il,[r("div",kl,[_.value?(n(),o("div",xl,[T(c,{size:"small",class:"rename-input",modelValue:h.value,"onUpdate:modelValue":l[0]||(l[0]=e=>h.value=e),clearable:"",ref_key:"renameInputRef",ref:p,maxlength:C(18)},null,8,["modelValue","maxlength"]),T(I,{size:"small"},{default:O((()=>[T(m,{onClick:l[1]||(l[1]=e=>_.value=!1)},{default:O((()=>[T(u)])),_:1}),T(m,{onClick:j(k,["prevent"])},{default:O((()=>[T(y)])),_:1})])),_:1})])):(n(),o("div",Sl,L(e.imageObj.name),1))])]),r("div",Tl,[T(R,{"img-obj":e.imageObj},null,8,["img-obj"])]),K(r("div",Ol,[r("div",Ll,[d.value?(n(),o("div",{key:0,class:N([e.imageObj.checked?"picked-btn":"pick-btn","operation-btn"]),onClick:l[2]||(l[2]=t=>{return(a=e.imageObj).checked=!a.checked,void i.commit("IMAGE_CARD",{imageObj:a});var a})},[e.imageObj.checked?(n(),E(P,{key:0},{default:O((()=>[T(y)])),_:1})):D("",!0)],2)):D("",!0)]),r("div",Cl,[T(M,{size:"default",trigger:"click",onVisibleChange:A},{dropdown:O((()=>[T(G,null,{default:O((()=>[T(z,{onClick:l[3]||(l[3]=t=>{return i=e.imageObj,void f.confirm(`\n    <div>${null==(l=null==a?void 0:a.proxy)?void 0:l.$t("management.delTips")}：</div>\n    <strong>${i.name}</strong>\n    `,null==(s=null==a?void 0:a.proxy)?void 0:s.$t("tips"),{dangerouslyUseHTMLString:!0,type:"warning"}).then((()=>{w(i)})).catch((()=>{}));var i,l,s})},{default:O((()=>[$(L(t.$t("upload.delete")),1)])),_:1}),T(z,{onClick:l[4]||(l[4]=j((t=>(async e=>{_.value=!0,h.value=sa(e.name),setTimeout((()=>{var e;null==(e=p.value)||e.focus()}),100)})(e.imageObj)),["self"]))},{default:O((()=>[$(L(t.$t("upload.rename")),1)])),_:1}),T(z,{onClick:l[5]||(l[5]=t=>{return i=e.imageObj,void f.confirm(`\n    <div>${null==(l=null==a?void 0:a.proxy)?void 0:l.$t("management.imageName")}：<strong>${i.name}</strong></div>\n    <div>${null==(s=null==a?void 0:a.proxy)?void 0:s.$t("management.imageSize")}：<strong>${ra(i.size)} KB</strong></div>\n    `,null==(n=null==a?void 0:a.proxy)?void 0:n.$t("management.property"),{showCancelButton:!1,showConfirmButton:!1,dangerouslyUseHTMLString:!0,type:"info"});var i,l,s,n})},{default:O((()=>[$(L(t.$t("management.property")),1)])),_:1})])),_:1})])),default:O((()=>[r("div",$l,[T(P,null,{default:O((()=>[T(U)])),_:1})])])),_:1})])],512),[[se,v.value||b.value||e.imageObj.checked]])],42,yl)),[[H,e.imageObj.deleting]])}}}),[["__scopeId","data-v-3010792e"]]);const Dl=e=>(H("data-v-f3498e7c"),e=e(),B(),e),Al=Dl((()=>r("div",{class:"icon"},[r("svg",{t:"1639999626518",class:"icon",viewBox:"0 0 1228 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3575",width:"200",height:"200"},[r("path",{d:"M1196.987733 212.5824v540.0576c0 39.594667-34.474667 71.3728-76.765866 71.3728H323.242667c-51.780267 0-88.746667-46.762667-73.250134-92.808533l126.737067-375.808H70.417067C31.675733 355.362133 0 326.4512 0 291.089067V98.372267C0 63.044267 31.675733 34.0992 70.417067 34.0992h378.811733c26.7264 0 51.029333 13.9264 63.010133 35.703467l39.048534 71.406933H1120.256c42.257067 0 76.8 32.119467 76.8 71.3728",fill:"#5398DF","p-id":"3576"}),r("path",{d:"M1128.721067 997.853867H68.266667a68.266667 68.266667 0 0 1-68.266667-68.266667V280.3712a68.266667 68.266667 0 0 1 68.266667-68.266667h1060.4544a68.266667 68.266667 0 0 1 68.266666 68.266667V929.5872a68.266667 68.266667 0 0 1-68.266666 68.266667",fill:"#85BCFF","p-id":"3577"})])],-1))),Rl={key:1,class:"text"},Pl={key:2,class:"icon"},Nl=[Dl((()=>r("svg",{t:"1640264285200",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"29312",width:"200",height:"200"},[r("path",{d:"M426.666667 384V213.333333l-298.666667 298.666667 298.666667 298.666667v-174.933334c213.333333 0 362.666667 68.266667 469.333333 217.6-42.666667-213.333333-170.666667-426.666667-469.333333-469.333333z","p-id":"29313",fill:"#85BCFF"})],-1)))],Ul={key:3,class:"text"};var zl=Ra(w({__name:"folder-card",props:{folderObj:{type:Object,default:()=>{}},mode:{type:String,default:"dir"}},setup(e){const t=Ca(),a=y((()=>t.getters.getUserConfigInfo)).value,i=e,l=()=>{const{folderObj:e,mode:l}=i;if("back"===l){const e=a.viewDir;if("/"===e)return;const t=e.split("/");1===t.length?a.viewDir="/":t.length>1&&(t.length-=1,a.viewDir=t.join("/"))}"dir"===l&&(a.viewDir=e.dirPath),t.dispatch("USER_CONFIG_INFO_PERSIST")};return(t,a)=>{const i=A;return n(),o("div",{class:"folder-card",onDblclick:l},["dir"===e.mode?(n(),E(i,{key:0,content:t.$t("management.toNextDir"),placement:"top"},{default:O((()=>[Al])),_:1},8,["content"])):D("",!0),"dir"===e.mode?(n(),o("div",Rl,L(e.folderObj.dir),1)):D("",!0),"back"===e.mode?(n(),o("div",Pl,Nl)):D("",!0),"back"===e.mode?(n(),o("div",Ul,L(t.$t("management.back")),1)):D("",!0)],32)}}}),[["__scopeId","data-v-f3498e7c"]]);const Gl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ml=[r("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"},null,-1)];var jl={name:"ep-delete",render:function(e,t){return n(),o("svg",Gl,[...Ml])}};const Hl={key:0,class:"selector-wrapper"},Bl={class:"selector-left-box"},Vl={class:"item"},Fl={class:"selector-right-box"};var Xl=Ra(w({__name:"image-selector",props:{currentDirImageList:{type:Array,default:()=>[]}},emits:["update:initImageList"],setup(e){const t=e,a=Ca(),i=I(!1),l=Z(),s=y((()=>a.getters.getImageCardCheckedArr)),c=y((()=>a.getters.getUserConfigInfo)).value,d=y((()=>a.getters.getUserSettings)).value,m=y((()=>s.value.length||0));F((()=>m.value),(e=>{const a=t.currentDirImageList.length;i.value=e===a}));const g=()=>{ha(s.value,c,d)},p=()=>{t.currentDirImageList.forEach((e=>{e.checked&&(e.checked=!1)}))},h=()=>{var e,t,a,i;(null==(e=s.value)?void 0:e.length)>0&&f.confirm(null==(a=null==l?void 0:l.proxy)?void 0:a.$t("management.delTips2",{total:null==(t=s.value)?void 0:t.length}),null==(i=null==l?void 0:l.proxy)?void 0:i.$t("tips"),{type:"warning"}).then((async()=>{var e,t,a;const i=await aa(s.value,c);i===rt.deleted&&u.success({message:null==(e=null==l?void 0:l.proxy)?void 0:e.$t("management.message5")}),i===rt.allDeleted&&u.success({message:null==(t=null==l?void 0:l.proxy)?void 0:t.$t("management.message6")}),i===rt.deleteFail&&u.error({message:null==(a=null==l?void 0:l.proxy)?void 0:a.$t("management.message7")})})).catch((()=>{}))},_=()=>{let e=[];t.currentDirImageList.forEach((e=>{e.checked=i.value})),e=t.currentDirImageList,a.commit("REPLACE_IMAGE_CARD",{checkedImgArr:e})};return k((()=>{_()})),(e,t)=>{const a=W,l=pl,s=S,c=A,d=jl;return m.value?(n(),o("div",Hl,[r("div",Bl,[T(a,{label:i.value?e.$t("management.deselectAll"):e.$t("management.selectAll"),modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),onChange:_},null,8,["label","modelValue"]),r("div",Vl,L(e.$t("management.selectTotal",{total:m.value})),1),r("div",{class:"item cancel-select-btn",onClick:p},L(e.$t("management.unselect")),1)]),r("div",Fl,[T(c,{placement:"top",content:e.$t("management.batchCopy")},{default:O((()=>[T(s,{class:"btn-icon",onClick:g},{default:O((()=>[T(l)])),_:1})])),_:1},8,["content"]),T(c,{placement:"top",content:e.$t("management.batchDelete")},{default:O((()=>[T(s,{class:"btn-icon",onClick:h},{default:O((()=>[T(d)])),_:1})])),_:1},8,["content"])])])):D("",!0)}}}),[["__scopeId","data-v-0ff830e2"]]);const Wl={class:"page-container management-page-container"},ql={class:"content-container"},Jl={class:"top"},Kl={class:"left"},Zl={class:"right flex-start"},Yl=["element-loading-text"],Ql={key:0,class:"image-management-item"},es=(e=>(H("data-v-400d1d22"),e=e(),B(),e))((()=>r("div",{style:{width:"100%"}},null,-1)));var ts=Ra(w({__name:"imgs-management",setup(e){const t=Ca(),a=Y(),i=y((()=>t.getters.getUserConfigInfo)).value,l=y((()=>t.getters.getUserLoginStatus)).value,s=y((()=>t.getters.getDirObject)).value,c=I((new Date).getTime()),d=I(!1),u=I([]),m=I([]),g=I(!1);async function p(e){d.value=!0;const a=it(e,s);if(a){const l=lt(0,a,"dir"),s=lt(0,a,"image");l.length||s.length?(u.value=l,m.value=s,t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:m.value})):await Xt(i,e)}else await Xt(i,e);d.value=!1}async function h(){const{viewDir:e}=i;await t.dispatch("DIR_IMAGE_LIST_INIT_DIR",e),d.value=!0,await Xt(i,e),d.value=!1}return k((()=>{!async function(){const{selectedDir:e,viewDir:t,dirMode:a}=i;""===t&&(a!==_t.newDir&&a!==_t.autoDir||it(e,s)||(i.selectedDir="/",i.dirMode="rootDir"),i.selectedDir?i.viewDir=i.selectedDir:i.viewDir="/"),s.imageList.length||s.childrenDirs.length?await p(i.viewDir):await Xt(i,i.viewDir)}()})),F((()=>l),(e=>{!1===e&&a.push("/config")})),F((()=>i.viewDir),(async e=>{await p(e),c.value+=1}),{deep:!0}),F((()=>s),(e=>{const{viewDir:a}=i,l=it(a,e);l&&(u.value=lt(0,l,"dir"),m.value=lt(0,l,"image"),t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:m.value}))}),{deep:!0}),F((()=>m.value),(e=>{g.value=e.filter((e=>e.checked)).length>0}),{deep:!0}),(e,t)=>{const a=rl,l=S,s=A,p=ne("contextmenu"),_=J;return n(),o("div",Wl,[r("div",ql,[r("div",Jl,[r("div",Kl,[T(si,{"bar-type":"management"})]),r("div",Zl,[T(s,{placement:"top",content:e.$t("management.reload",{dir:C(i).viewDir})},{default:O((()=>[T(l,{class:"btn-icon",onClick:j(h,["stop"])},{default:O((()=>[T(a)])),_:1})])),_:1},8,["content"])])]),K((n(),o("div",{class:"bottom","element-loading-text":e.$t("management.loadingTxt1")},[m.value.length?(n(),E(Xl,{currentDirImageList:m.value,"onUpdate:initImageList":m.value,key:c.value},null,8,["currentDirImageList","onUpdate:initImageList"])):D("",!0),K((n(),o("ul",{class:"image-management-list",style:z({height:g.value?"calc(100% - 50rem)":"100%"})},["/"!==C(i).viewDir?(n(),o("li",Ql,[T(zl,{mode:"back"})])):D("",!0),(n(!0),o(R,null,P(u.value,((e,t)=>K((n(),o("li",{class:"image-management-item",key:"folder-card-"+e.dir+"-"+t},[T(zl,{"folder-obj":e},null,8,["folder-obj"])])),[[p,{type:C(Tt).childDir,dir:e.dir}]]))),128)),es,(n(!0),o(R,null,P(m.value,((e,t)=>K((n(),o("li",{class:"image-management-item image",key:"image-card-"+t},[T(El,{"image-obj":e},null,8,["image-obj"])])),[[p,{type:C(Tt).img,img:e}]]))),128))],4)),[[p,{type:C(Tt).parentDir}]])],8,Yl)),[[_,d.value]])])])}}}),[["__scopeId","data-v-400d1d22"]]);const as={class:"card-header"},is=["onFocusout"],ls={style:{"margin-top":"20px"}};var ss=Ra(w({__name:"image-link-rule-config",setup(e){const t=Z(),a=y((()=>Oa.getters.getUserSettings)).value,i=y((()=>{const e=[];for(const t in a.imageLinkType.presetList)e.push(a.imageLinkType.presetList[t]);return e})),l=I(),s=V({id:"",name:"",rule:"",editable:!0});return(e,a)=>{const o=oe,c=jl,d=x,u=re,m=ce,g=q,p=de,h=ue,_=me;return n(),E(_,null,{header:O((()=>[r("div",as,[r("span",null,L(e.$t("settings.link_rule.card_title")),1)])])),default:O((()=>[T(u,{data:i.value,style:{width:"100%"}},{default:O((()=>[T(o,{prop:"name",label:e.$t("settings.link_rule.card_table_col_title_1"),width:"120"},null,8,["label"]),T(o,{label:e.$t("settings.link_rule.card_table_col_title_2")},{default:O((e=>[r("div",{contenteditable:!0,onFocusout:a=>((e,a)=>{var i;const l=JSON.parse(JSON.stringify(a));l.rule=e,Oa.dispatch("UPDATE_IMAGE_LINK_TYPE_RULE",{rule:l,$t:null==(i=null==t?void 0:t.proxy)?void 0:i.$t})})(a.target.innerHTML,e.row)},L(e.row.rule),41,is)])),_:1},8,["label"]),T(o,{label:e.$t("settings.link_rule.card_table_col_title_3"),width:"80",align:"center"},{default:O((e=>[T(d,{link:"",size:"small",disabled:!e.row.editable,onClick:a=>{return i=e.row,void f.confirm(`${null==(l=null==t?void 0:t.proxy)?void 0:l.$t("settings.link_format.delete_tips")}：<strong>${i.name}</strong>`,null==(s=null==t?void 0:t.proxy)?void 0:s.$t("tips"),{dangerouslyUseHTMLString:!0,type:"warning"}).then((()=>{Oa.dispatch("DEL_IMAGE_LINK_TYPE_RULE",i)})).catch((()=>{}));var i,l,s}},{default:O((()=>[T(c)])),_:2},1032,["disabled","onClick"])])),_:1},8,["label"])])),_:1},8,["data"]),T(m),r("div",ls,[T(h,{ref_key:"formRef",ref:l,"label-position":"left",model:s,"label-width":"120px",size:"default"},{default:O((()=>[T(p,{label:e.$t("settings.link_rule.input_name_1"),prop:"name",rules:[{required:!0,message:e.$t("settings.link_rule.input_name_1_rule")}]},{default:O((()=>[T(g,{modelValue:s.name,"onUpdate:modelValue":a[0]||(a[0]=e=>s.name=e),type:"text"},null,8,["modelValue"])])),_:1},8,["label","rules"]),T(p,{label:e.$t("settings.link_rule.input_name_2"),prop:"rule",rules:[{required:!0,message:e.$t("settings.link_rule.input_name_2_rule")}]},{default:O((()=>[T(g,{modelValue:s.rule,"onUpdate:modelValue":a[1]||(a[1]=e=>s.rule=e),type:"text"},null,8,["modelValue"])])),_:1},8,["label","rules"]),T(p,null,{default:O((()=>[T(d,{type:"primary",disabled:!s.name||!s.rule,onClick:a[2]||(a[2]=e=>{var a;(a=l.value)&&a.validate((e=>{var a;e&&(s.id=At(),Oa.dispatch("ADD_IMAGE_LINK_TYPE_RULE",{rule:JSON.parse(JSON.stringify(s)),$t:null==(a=null==t?void 0:t.proxy)?void 0:a.$t}))}))})},{default:O((()=>[$(L(e.$t("settings.link_rule.btn_name_1")),1)])),_:1},8,["disabled"])])),_:1})])),_:1},8,["model"])])])),_:1})}}}),[["__scopeId","data-v-a0fb0ee0"]]);const ns={class:"compress-config-box"},os={class:"img-encoder-title"},rs={class:"desc"},cs={class:"desc"},ds={class:"desc"};var us=Ra(w({__name:"compress-config-box",props:{disabled:{type:Boolean,default:!1},usageScenario:{type:String,default:"toolbox"}},emits:["encoder"],setup(e,{expose:t,emit:a}){const i=y((()=>Oa.getters.getUserSettings)).value,l=I(dt.webP),s=a,c=e,d=e=>{s("encoder",e)};return k((()=>{"imageHosting"===c.usageScenario&&(l.value=i.compress.encoder),s("encoder",l.value)})),t({reset:()=>{l.value=dt.webP}}),(t,a)=>{const i=ge,s=pe;return n(),o("div",ns,[r("div",os,L(t.$t("settings.img_compress.radio_group_title")),1),T(s,{disabled:e.disabled,class:"img-encoder-group",modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),onChange:d},{default:O((()=>[T(i,{label:C(dt).webP},{default:O((()=>[$(L(C(dt).webP)+" ",1),r("span",rs,L(t.$t("settings.img_compress.radio_1_desc")),1)])),_:1},8,["label"]),T(i,{label:C(dt).mozJPEG},{default:O((()=>[$(L(C(dt).mozJPEG)+" ",1),r("span",cs,L(t.$t("settings.img_compress.radio_2_desc")),1)])),_:1},8,["label"]),T(i,{label:C(dt).avif},{default:O((()=>[$(L(C(dt).avif)+" ",1),r("span",ds,L(t.$t("settings.img_compress.radio_3_desc")),1)])),_:1},8,["label"])])),_:1},8,["disabled","modelValue"])])}}}),[["__scopeId","data-v-186c475a"]]);const ms=w({__name:"watermark-config-box",props:{isTool:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["watermarkConfig"],setup(e,{emit:t}){const a=V({text:"",fontSize:0,position:yt.rightBottom,textColor:"",opacity:0}),i=t,l=()=>{i("watermarkConfig",a)};return k((()=>{const e=Oa.getters.getUserSettings.watermark;a.text=e.text,a.textColor=e.textColor,a.fontSize=e.fontSize,a.position=e.position,a.opacity=e.opacity,i("watermarkConfig",a)})),(t,i)=>{const s=q,o=de,r=he,c=_e,d=fe,u=ge,m=pe,g=ve,p=ue;return n(),E(p,{class:"watermark-config-form","label-position":"left","label-width":"90rem",disabled:e.disabled},{default:O((()=>[T(g,null,{default:O((()=>[T(r,{span:24},{default:O((()=>[T(o,{label:t.$t("settings.img_watermark.text")},{default:O((()=>[T(s,{modelValue:a.text,"onUpdate:modelValue":i[0]||(i[0]=e=>a.text=e),placeholder:t.$t("settings.img_watermark.text_input_placeholder"),clearable:"",maxlength:"20",onInput:l},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),T(r,{span:e.isTool?10:24},{default:O((()=>[T(o,{label:t.$t("settings.img_watermark.size")},{default:O((()=>[T(c,{modelValue:a.fontSize,"onUpdate:modelValue":i[1]||(i[1]=e=>a.fontSize=e),min:40,max:80,step:2,onChange:l},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"]),T(r,{span:e.isTool?14:24},{default:O((()=>[T(o,{label:t.$t("settings.img_watermark.color")},{default:O((()=>[T(d,{modelValue:a.textColor,"onUpdate:modelValue":i[2]||(i[2]=e=>a.textColor=e),onChange:l},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"]),T(r,{span:e.isTool?10:24},{default:O((()=>[T(o,{label:t.$t("settings.img_watermark.opacity")},{default:O((()=>[T(c,{modelValue:a.opacity,"onUpdate:modelValue":i[3]||(i[3]=e=>a.opacity=e),precision:1,step:.1,min:.1,max:.9,onChange:l},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"]),T(r,{span:e.isTool?14:24},{default:O((()=>[T(o,{label:t.$t("settings.img_watermark.position")},{default:O((()=>[T(m,{modelValue:a.position,"onUpdate:modelValue":i[4]||(i[4]=e=>a.position=e),onChange:l},{default:O((()=>[T(u,{label:C(yt).leftTop},{default:O((()=>[$(L(t.$t("settings.img_watermark.position_1")),1)])),_:1},8,["label"]),T(u,{label:C(yt).leftBottom},{default:O((()=>[$(L(t.$t("settings.img_watermark.position_2")),1)])),_:1},8,["label"]),T(u,{label:C(yt).rightTop},{default:O((()=>[$(L(t.$t("settings.img_watermark.position_3")),1)])),_:1},8,["label"]),T(u,{label:C(yt).rightBottom},{default:O((()=>[$(L(t.$t("settings.img_watermark.position_4")),1)])),_:1},8,["label"])])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"])])),_:1})])),_:1},8,["disabled"])}}});var gs,ps;(ps=gs||(gs={}))[ps.save=0]="save",ps[ps.use=1]="use",ps[ps.update=2]="update",ps[ps.equal=3]="equal";const hs=async e=>{const{owner:t,selectedRepo:a}=e,i=await Vt({url:`/repos/${t}/${a}/contents/.settings`,method:"GET",noShowErrorMsg:!0,cache:{maxAge:0},params:{timestamp:Date.now()}});return Promise.resolve(i)};const _s={class:"cloud-settings-data-box border-box"};var fs=Ra(w({__name:"cloud-settings-bar",setup(e){const t=Z(),a=y((()=>Oa.getters.getUserSettings)).value,i=y((()=>Oa.getters.getUserConfigInfo)).value,l=be({IEpCheck:bi,IEpClose:bl}),s=I(null),c=I(!1),d=I(!1),m=I(gs.save),g=y((()=>{var e,a,i,l,s;switch(m.value){case gs.save:return null==(e=null==t?void 0:t.proxy)?void 0:e.$t("settings.cloud_settings.tip_1");case gs.use:return null==(a=null==t?void 0:t.proxy)?void 0:a.$t("settings.cloud_settings.tip_2");case gs.update:return null==(i=null==t?void 0:t.proxy)?void 0:i.$t("settings.cloud_settings.tip_3");case gs.equal:return null==(l=null==t?void 0:t.proxy)?void 0:l.$t("settings.cloud_settings.tip_4");default:return null==(s=null==t?void 0:t.proxy)?void 0:s.$t("settings.cloud_settings.tip_1")}})),p=async()=>{var e,l;c.value=!0,await(async(e,t)=>{const{owner:a,selectedRepo:i,selectedBranch:l}=t,s=await hs(t),n={message:s?"Update settings via PicX (https://github.com/XPoet/picx)":"Init settings via PicX (https://github.com/XPoet/picx)",content:window.btoa(JSON.stringify(e))};s?n.sha=s.sha:n.branch=l;const o=await Vt({url:`/repos/${a}/${i}/contents/.settings`,method:"PUT",data:n,noShowErrorMsg:!0});return Promise.resolve(o)})(a,i),c.value=!1,s.value=JSON.parse(JSON.stringify(a)),u.success(null===s.value?null==(e=null==t?void 0:t.proxy)?void 0:e.$t("settings.cloud_settings.success_msg_1"):null==(l=null==t?void 0:t.proxy)?void 0:l.$t("settings.cloud_settings.success_msg_2"))},h=()=>{switch(m.value){case gs.save:case gs.update:p();break;case gs.use:s.value&&(Nt(a,s.value),Oa.dispatch("USER_SETTINGS_PERSIST"))}};return F((()=>a),(e=>{s.value&&(Gt(e,s.value)?(m.value=gs.equal,d.value=!0):(m.value=gs.update,d.value=!1))}),{deep:!0}),F((()=>s.value),(e=>{null===e&&(m.value=gs.save),e&&(m.value=gs.use),e&&Gt(e,a)?(d.value=!0,m.value=gs.equal):(d.value=!1,m.value=gs.update)}),{deep:!0}),k((()=>{(async()=>{const e=await hs(i);s.value=e?JSON.parse(window.atob(e.content)):null})()})),(e,t)=>{const a=x;return n(),o("div",_s,[r("div",null,L(g.value),1),T(a,{type:"primary",text:"",icon:l.value.IEpCheck,loading:c.value,disabled:d.value,onClick:h},{default:O((()=>[$(L(e.$t("confirm")),1)])),_:1},8,["icon","loading","disabled"])])}}}),[["__scopeId","data-v-0476a1bd"]]);const vs={class:"page-container settings-page-container"},bs={class:"setting-list",style:{"margin-top":"10rem"}},ys={class:"setting-item has-desc"},ws={class:"desc"},Is={class:"setting-item has-desc"},ks={class:"desc"},xs={key:0,class:"setting-item has-desc"},Ss={class:"setting-item has-desc"},Ts={class:"setting-list"},Os={class:"setting-item has-desc"},Ls={class:"desc"},Cs={class:"setting-item"},$s={class:"setting-list"},Es={class:"setting-item has-desc"},Ds={class:"desc"},As={class:"setting-item"},Rs={class:"setting-list"},Ps={class:"setting-item cdn"},Ns={class:"left"},Us={class:"right"},zs={class:"setting-item",style:{"margin-top":"20rem"}},Gs={class:"setting-list"},Ms={class:"setting-item has-desc"},js={class:"desc"},Hs={class:"setting-item"},Bs={class:"left"},Vs={class:"right"},Fs={class:"setting-list"},Xs={class:"setting-item"};var Ws=Ra(w({__name:"my-settings",setup(e){const t=y((()=>Oa.getters.getUserSettings)).value,a=()=>{Oa.dispatch("USER_SETTINGS_PERSIST")},i=()=>{Oa.dispatch("SET_USER_SETTINGS",s({},t))},l=e=>{t.watermark.text=e.text,t.watermark.textColor=e.textColor,t.watermark.opacity=e.opacity,t.watermark.position=e.position,t.watermark.fontSize=e.fontSize,a()};return F((()=>t.imageName.autoTimestampNaming),(e=>{e?(t.imageName.autoAddHash=!1,t.imageName.prefixNaming.enable=!1):t.imageName.autoAddHash=!0,a()}),{immediate:!0,deep:!0}),(e,s)=>{const c=fs,d=ye,u=q,m=we,g=ms,p=me,h=us,_=Ie,f=ke,v=ss,b=Qa,y=xe;return n(),o("div",vs,[T(c,{style:{"margin-bottom":"20rem"}}),T(y,null,{default:O((()=>[T(m,{title:e.$t("settings.img_name.title"),name:"1"},{default:O((()=>[r("ul",bs,[r("li",ys,[T(d,{modelValue:C(t).imageName.autoAddHash,"onUpdate:modelValue":s[0]||(s[0]=e=>C(t).imageName.autoAddHash=e),onChange:a,"active-text":e.$t("settings.img_name.hash_switch_name")},null,8,["modelValue","active-text"]),r("span",ws,L(e.$t("settings.img_name.hash_switch_desc")),1)]),r("li",Is,[T(d,{modelValue:C(t).imageName.prefixNaming.enable,"onUpdate:modelValue":s[1]||(s[1]=e=>C(t).imageName.prefixNaming.enable=e),onChange:a,"active-text":e.$t("settings.img_name.prefix_switch_name")},null,8,["modelValue","active-text"]),r("span",ks,L(e.$t("settings.img_name.prefix_switch_desc")),1)]),C(t).imageName.prefixNaming.enable?(n(),o("li",xs,[T(u,{class:"prefix-input",modelValue:C(t).imageName.prefixNaming.prefix,"onUpdate:modelValue":s[2]||(s[2]=e=>C(t).imageName.prefixNaming.prefix=e),placeholder:e.$t("settings.img_name.prefix_input_placeholder"),onInput:a,clearable:"",autofocus:""},null,8,["modelValue","placeholder"])])):D("",!0),r("li",Ss,[T(d,{modelValue:C(t).imageName.autoTimestampNaming,"onUpdate:modelValue":s[3]||(s[3]=e=>C(t).imageName.autoTimestampNaming=e),onChange:a,"active-text":e.$t("settings.img_name.timestamp_switch_name")},null,8,["modelValue","active-text"])])])])),_:1},8,["title"]),T(m,{title:e.$t("settings.img_watermark.title"),name:"2"},{default:O((()=>[r("ul",Ts,[r("li",Os,[T(d,{modelValue:C(t).watermark.enable,"onUpdate:modelValue":s[4]||(s[4]=e=>C(t).watermark.enable=e),onChange:a,"active-text":e.$t("settings.img_watermark.switch_name")},null,8,["modelValue","active-text"]),r("span",Ls,L(e.$t("settings.img_watermark.switch_desc")),1)]),r("li",Cs,[T(p,{class:"settings-item-card"},{default:O((()=>[T(g,{disabled:!C(t).watermark.enable,onWatermarkConfig:l},null,8,["disabled"])])),_:1})])])])),_:1},8,["title"]),T(m,{title:e.$t("settings.img_compress.title"),name:"3"},{default:O((()=>[r("ul",$s,[r("li",Es,[T(d,{modelValue:C(t).compress.enable,"onUpdate:modelValue":s[5]||(s[5]=e=>C(t).compress.enable=e),onChange:a,"active-text":e.$t("settings.img_compress.switch_name")},null,8,["modelValue","active-text"]),r("span",Ds,L(e.$t("settings.img_compress.switch_desc")),1)]),r("li",As,[T(p,{class:"settings-item-card"},{default:O((()=>[T(h,{ref:"compressConfigBoxRef","usage-scenario":"imageHosting",disabled:!C(t).compress.enable,onEncoder:s[6]||(s[6]=e=>{C(t).compress.encoder=e,a()})},null,8,["disabled"])])),_:1})])])])),_:1},8,["title"]),T(m,{title:e.$t("settings.link_rule.title"),name:"4"},{default:O((()=>[r("ul",Rs,[r("li",Ps,[$(L(e.$t("settings.link_rule.select_title"))+"： ",1),T(f,{modelValue:C(t).imageLinkType.selected,"onUpdate:modelValue":s[7]||(s[7]=e=>C(t).imageLinkType.selected=e),onChange:i},{default:O((()=>[(n(!0),o(R,null,P(C(t).imageLinkType.presetList,(e=>{return n(),E(_,{key:e.name+"-"+e.id,label:e.name,value:e.name,disabled:(a=e.name,a===mt.GitHubPages&&!t.deploy.github.status),class:"image-link-type-rule-option"},{default:O((()=>[r("span",Ns,L(e.name),1),r("span",Us,L(e.rule),1)])),_:2},1032,["label","value","disabled"]);var a})),128))])),_:1},8,["modelValue"])]),r("li",zs,[T(v)])])])),_:1},8,["title"]),T(m,{title:e.$t("settings.link_format.title"),name:"5"},{default:O((()=>[r("ul",Gs,[r("li",Ms,[T(d,{modelValue:C(t).imageLinkFormat.enable,"onUpdate:modelValue":s[8]||(s[8]=e=>C(t).imageLinkFormat.enable=e),onChange:a,"active-text":e.$t("settings.link_format.switch_name")},null,8,["modelValue","active-text"]),r("span",js,L(e.$t("settings.link_format.switch_desc",{type:C(t).imageLinkFormat.selected})),1)]),r("li",Hs,[$(L(e.$t("settings.link_format.select_title"))+"： ",1),T(f,{modelValue:C(t).imageLinkFormat.selected,"onUpdate:modelValue":s[9]||(s[9]=e=>C(t).imageLinkFormat.selected=e),onChange:i},{default:O((()=>[(n(!0),o(R,null,P(C(t).imageLinkFormat.presetList,((e,t)=>(n(),E(_,{key:t+e.name,label:e.name,value:e.name,class:"image-link-type-rule-option"},{default:O((()=>[r("span",Bs,L(e.name),1),r("span",Vs,L(e.format),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1},8,["title"]),T(m,{title:e.$t("settings.image_hosting_deploy.title"),name:"6"},{default:O((()=>[T(b)])),_:1},8,["title"]),T(m,{title:e.$t("settings.theme.title"),name:"7"},{default:O((()=>[r("ul",Fs,[r("li",Xs,[$(L(e.$t("header.theme"))+"： ",1),T(f,{modelValue:C(t).theme.mode,"onUpdate:modelValue":s[10]||(s[10]=e=>C(t).theme.mode=e),onChange:i},{default:O((()=>[T(_,{label:e.$t("settings.theme.system"),value:C(It).system},null,8,["label","value"]),T(_,{label:e.$t("settings.theme.light"),value:C(It).light},null,8,["label","value"]),T(_,{label:e.$t("settings.theme.dark"),value:C(It).dark},null,8,["label","value"])])),_:1},8,["modelValue"])])])])),_:1},8,["title"])])),_:1})])}}}),[["__scopeId","data-v-5e84d694"]]);const qs={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Js=[r("path",{fill:"currentColor",d:"M512 64h64v192h-64zm0 576h64v192h-64zM160 480v-64h192v64zm576 0v-64h192v64zM249.856 199.04l45.248-45.184L430.848 289.6L385.6 334.848L249.856 199.104zM657.152 606.4l45.248-45.248l135.744 135.744l-45.248 45.248zM114.048 923.2L68.8 877.952l316.8-316.8l45.248 45.248zM702.4 334.848L657.152 289.6l135.744-135.744l45.248 45.248z"},null,-1)];var Ks={name:"ep-magic-stick",render:function(e,t){return n(),o("svg",qs,[...Js])}};const Zs={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ys=[r("path",{fill:"currentColor",d:"M602.496 240.448A192 192 0 1 1 874.048 512l-316.8 316.8A256 256 0 0 1 195.2 466.752L602.496 59.456l45.248 45.248L240.448 512A192 192 0 0 0 512 783.552l316.8-316.8a128 128 0 1 0-181.056-181.056L353.6 579.904a32 32 0 1 0 45.248 45.248l294.144-294.144l45.312 45.248L444.096 670.4a96 96 0 1 1-135.744-135.744z"},null,-1)];var Qs={name:"ep-paperclip",render:function(e,t){return n(),o("svg",Zs,[...Ys])}};const en={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},tn=[r("path",{fill:"currentColor",d:"M160 224a32 32 0 0 0-32 32v512a32 32 0 0 0 32 32h704a32 32 0 0 0 32-32V256a32 32 0 0 0-32-32zm0-64h704a96 96 0 0 1 96 96v512a96 96 0 0 1-96 96H160a96 96 0 0 1-96-96V256a96 96 0 0 1 96-96"},null,-1),r("path",{fill:"currentColor",d:"M704 320a64 64 0 1 1 0 128a64 64 0 0 1 0-128M288 448h256q32 0 32 32t-32 32H288q-32 0-32-32t32-32m0 128h256q32 0 32 32t-32 32H288q-32 0-32-32t32-32"},null,-1)];var an={name:"ep-postcard",render:function(e,t){return n(),o("svg",en,[...tn])}};const ln=be([{name:"toolbox.tool_1",desc:"toolbox.tool_1_desc",icon:Ks,uuid:At(),path:"/compress"},{name:"toolbox.tool_2",desc:"toolbox.tool_2_desc",icon:Qs,uuid:At(),path:"/base64"},{name:"toolbox.tool_3",desc:"toolbox.tool_3_desc",icon:an,uuid:At(),path:"/watermark"}]);const sn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},nn=[r("path",{fill:"currentColor",d:"M340.864 149.312a30.59 30.59 0 0 0 0 42.752L652.736 512L340.864 831.872a30.59 30.59 0 0 0 0 42.752a29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1)];var on={name:"ep-arrow-right",render:function(e,t){return n(),o("svg",sn,[...nn])}};const rn={class:"page-container"},cn={key:0,class:"tool-panel"},dn={class:"panel-header"},un={class:"panel-body"},mn={key:1,class:"toolbox"},gn=["onClick"],pn={class:"top"},hn={class:"left flex-center"},_n={class:"right"},fn={class:"bottom"};var vn=Ra(w({__name:"picx-toolbox",setup(e){const t=be(on),a=Y(),i=I("/toolbox"),l=I(!1),c=I({path:"",icon:"",name:"",desc:"",uuid:""}),d=e=>{l.value=!0,c.value=s({},e),Oa.dispatch("TOOLBOX_IMG_LIST_RESET"),a.push(`${i.value}${e.path}`)};F((()=>a.currentRoute.value),(e=>{e.path===i.value&&(l.value=!1)}),{deep:!0});return k((()=>{a.isReady().then((()=>{const e=a.currentRoute.value.path;if(i.value!==e){const t=e.substring(e.lastIndexOf("/")),a=ln.value.find((e=>e.path===t));a&&d(a)}}))})),(e,a)=>{const s=Se,u=Te,m=Oe("router-view"),g=S;return n(),o("div",rn,[l.value?(n(),o("div",cn,[r("div",dn,[T(u,{"separator-icon":t.value},{default:O((()=>[T(s,{to:{path:i.value}},{default:O((()=>[$(L(e.$t("nav.toolbox")),1)])),_:1},8,["to"]),T(s,null,{default:O((()=>[$(L(e.$t(c.value.name)),1)])),_:1})])),_:1},8,["separator-icon"])]),r("div",un,[T(m)])])):(n(),o("ul",mn,[(n(!0),o(R,null,P(C(ln),(t=>(n(),o("li",{class:"tool-item",key:t.uuid,onClick:e=>d(t)},[r("div",pn,[r("div",hn,[T(g,{size:30},{default:O((()=>[(n(),E(Le(t.icon)))])),_:2},1024)]),r("div",_n,L(e.$t(t.name)),1)]),r("div",fn,L(e.$t(t.desc)),1)],8,gn)))),128))]))])}}}),[["__scopeId","data-v-06af4a8d"]]);const bn={class:"page-container feedback-page-container"},yn={class:"help-info-item description"},wn={class:"help-info-item"},In={class:"help-info-item"},kn={class:"help-info-item"},xn={class:"help-info-item"},Sn={class:"help-info-item",style:{"margin-bottom":"2rem"}},Tn={class:"help-info-item img"},On={class:"help-info-item red-text"};var Ln=Ra(w({__name:"feedback-info",setup(e){const t=y((()=>"win"===_a()?"Ctrl + D":"Command + D"));return(e,a)=>{const i=Ce,l=X;return n(),o("div",bn,[r("div",yn,"🏞️ "+L(e.$t("feedback.text_1")),1),r("div",wn,[$(" 🌍 "+L(e.$t("feedback.text_2"))+" "+L(e.$t("shortcut_key"))+"：",1),r("code",null,L(t.value),1)]),r("div",In,[$(" 🦁 "+L(e.$t("author"))+"： ",1),T(i,{type:"primary",href:"https://xpoet.cn/",target:"_blank"},{default:O((()=>[$("@XPoet")])),_:1})]),r("div",kn,[$(" 🌀 "+L(e.$t("repo"))+"： ",1),T(i,{type:"primary",href:"https://github.com/XPoet/picx",target:"_blank"},{default:O((()=>[$(" https://github.com/XPoet/picx ")])),_:1})]),r("div",xn,[$(" 📖 "+L(e.$t("document"))+"： ",1),T(i,{type:"primary",href:"https://picx-docs.xpoet.cn",target:"_blank"},{default:O((()=>[$(" https://picx-docs.xpoet.cn ")])),_:1})]),r("div",Sn,"🎁 "+L(e.$t("feedback.text_3")),1),r("div",Tn,[T(l,{style:{width:"300rem"},src:"https://xpoet.cn/images/admire-code-wechat.webp"})]),r("div",On,[r("strong",null," ⚠️ "+L(e.$t("feedback.text_4")),1)])])}}}),[["__scopeId","data-v-3aecdb24"]]);const Cn={class:"img-process-state-card-container"},$n={class:"img-container"},En={class:"info-container"},Dn={class:"img-name text-ellipsis"},An={class:"img-size"},Rn={key:0,class:"finial-file-size file-size-item"};var Pn=Ra(w({__name:"img-process-state-card",props:{imgObj:{type:Object,require:!0,default:()=>({})},cardType:{type:String,default:"compress"}},emits:["remove"],setup(e,{emit:t}){const a=t;return(t,i)=>{const l=X,s=Si,c=S,d=A,m=J;return n(),o("div",Cn,[K((n(),o("div",$n,[T(l,{src:e.imgObj.finialBase64||e.imgObj.originalBase64,fit:"cover",loading:"lazy","hide-on-click-modal":!0,"preview-src-list":[e.imgObj.finialBase64||e.imgObj.originalBase64]},null,8,["src","preview-src-list"])])),[[m,e.imgObj.processing]]),r("div",En,[r("div",Dn,L(e.imgObj.finialName||e.imgObj.originalName),1),r("div",An,[r("div",{class:N(["original-file-size file-size-item",{"del-line":e.imgObj.finialSize&&"compress"===e.cardType}])},L(C(ra)(e.imgObj.originalSize))+" KB ",3),e.imgObj.finialSize&&"compress"===e.cardType?(n(),o("div",Rn,L(C(ra)(e.imgObj.finialSize))+" KB ",1)):D("",!0)])]),e.imgObj.finialFile?(n(),o("div",{key:0,class:"operate-container flex-center",onClick:i[0]||(i[0]=t=>{la(e.imgObj.finialFile)})},L(t.$t("toolbox.click_download")),1)):D("",!0),"base64"===e.cardType&&e.imgObj.originalBase64?(n(),o("div",{key:1,class:"operate-container flex-center",onClick:i[1]||(i[1]=a=>{return i=e.imgObj.originalBase64,l=t.$t,void Rt(i,(()=>{u.success({message:l("toolbox.copy_base64_success")})}));var i,l})},L(t.$t("toolbox.copy_base64")),1)):D("",!0),T(d,{placement:"top",offset:8,content:t.$t("delete")},{default:O((()=>[T(c,{class:"del-btn",onClick:i[2]||(i[2]=t=>{return i=e.imgObj.uuid,void a("remove",i);var i})},{default:O((()=>[T(s)])),_:1})])),_:1},8,["content"])])}}}),[["__scopeId","data-v-d59c7528"]]);const Nn={class:"compress-tool-container"},Un={key:0,class:"compress-tool-left"};var zn=Ra(w({__name:"compress-tool",setup(e){const t=Ca(),a=I(null),i=I(null),l=I([]),s=I(dt.webP),c=I(!1),d=I(!1),u=e=>{d.value=!1,c.value=!1,e.forEach((e=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:e.uuid,originalName:e.file.name,originalSize:e.file.size,originalBase64:e.base64,originalFile:e.file})}))},m=()=>{var e,l;t.dispatch("TOOLBOX_IMG_LIST_RESET"),d.value=!1,null==(e=a.value)||e.reset(),null==(l=i.value)||l.reset()},g=async()=>{c.value=!0;for(const e of l.value)e.processing=!0,e.finialFile=await da(e.originalFile,s.value),e.finialBase64=await ia(e.finialFile)||"",e.finialSize=e.finialFile.size,e.finialName=e.finialFile.name,e.processing=!1;d.value=!0,c.value=!1},p=()=>{l.value.forEach((e=>{la(e.finialFile)}))},h=e=>{var i;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",e),null==(i=a.value)||i.remove(e)};return F((()=>t.state.toolboxImageListModule.toolboxImageList),(e=>{l.value=e}),{immediate:!0,deep:!0}),(e,t)=>{const _=Pn,f=gi,v=us,b=x;return n(),o("div",Nn,[l.value.length?(n(),o("div",Un,[(n(!0),o(R,null,P(l.value,(e=>(n(),E(_,{"img-obj":e,key:e.uuid,onRemove:h},null,8,["img-obj"])))),128))])):D("",!0),r("div",{class:N(["compress-tool-right",{"no-img":!l.value.length}])},[T(f,{ref_key:"gettingImagesRef",ref:a,onGetImgList:u},null,512),T(v,{ref_key:"compressConfigBoxRef",ref:i,style:{"margin-top":"18rem"},onEncoder:t[0]||(t[0]=e=>{return t=e,d.value=!1,void(s.value=t);var t})},null,512),r("div",{class:N(["user-operate",{compressed:d.value&&l.value.length>1}])},[d.value&&l.value.length>1?(n(),E(b,{key:0,plain:"",type:"success",onClick:p},{default:O((()=>[$(L(e.$t("toolbox.batch_download")),1)])),_:1})):D("",!0),r("div",null,[l.value.length?(n(),E(b,{key:0,plain:"",type:"warning",onClick:m},{default:O((()=>[$(L(e.$t("reset")),1)])),_:1})):D("",!0),l.value.length?(n(),E(b,{key:1,disabled:c.value||d.value,plain:"",type:"primary",onClick:g},{default:O((()=>[$(L(e.$t("toolbox.compress")),1)])),_:1},8,["disabled"])):D("",!0)])],2)],2)])}}}),[["__scopeId","data-v-2f45486b"]]);const Gn={class:"base64-tool-container"},Mn={key:0,class:"base64-tool-left"},jn={class:"user-operate"},Hn=w({__name:"base64-tool",setup(e){const t=Ca(),a=I(null),i=I([]),l=e=>{e.forEach((e=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:e.uuid,originalName:e.file.name,originalSize:e.file.size,originalBase64:e.base64})}))},s=()=>{var e;t.dispatch("TOOLBOX_IMG_LIST_RESET"),null==(e=a.value)||e.reset()},c=e=>{var i;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",e),null==(i=a.value)||i.remove(e)};return F((()=>t.state.toolboxImageListModule.toolboxImageList),(e=>{i.value=e}),{immediate:!0,deep:!0}),(e,t)=>{const d=Pn,u=gi,m=x;return n(),o("div",Gn,[i.value.length?(n(),o("div",Mn,[(n(!0),o(R,null,P(i.value,(e=>(n(),E(d,{"card-type":"base64","img-obj":e,key:e.uuid,onRemove:c},null,8,["img-obj"])))),128))])):D("",!0),r("div",{class:N(["base64-tool-right",{"no-img":!i.value.length}])},[T(u,{ref_key:"gettingImagesRef",ref:a,onGetImgList:l},null,512),r("div",jn,[i.value.length?(n(),E(m,{key:0,plain:"",type:"warning",onClick:s},{default:O((()=>[$(L(e.$t("reset")),1)])),_:1})):D("",!0)])],2)])}}});const Bn={class:"watermark-tool-container"},Vn={key:0,class:"watermark-tool-left"};const Fn=[{path:"/",name:"login",component:Ha,meta:{title:"nav.login"}},{path:"/config",name:"config",component:()=>{return e=()=>import("./my-config.41db6deb.js"),(t=["assets/my-config.41db6deb.js","assets/my-config.a95d7ba2.css","assets/vendor.cefe23a2.js","assets/vendor.941a5151.css"])&&0!==t.length?Promise.all(t.map((e=>{if((e=`./${e}`)in Me)return;Me[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script",i.crossOrigin=""),i.href=e,document.head.appendChild(i),t?new Promise(((e,t)=>{i.addEventListener("load",e),i.addEventListener("error",t)})):void 0}))).then((()=>e())):e();var e,t},meta:{title:"nav.config"}},{path:"/upload",name:"upload",component:sl,meta:{title:"nav.upload"}},{path:"/management",name:"Management",component:ts,meta:{title:"nav.management"}},{path:"/settings",name:"settings",component:Ws,meta:{title:"nav.settings"}},{path:"/toolbox",name:"Toolbox",component:vn,meta:{title:"nav.toolbox"},children:[{path:"/toolbox/compress",name:"Compress",component:zn},{path:"/toolbox/base64",name:"Base64",component:Ra(Hn,[["__scopeId","data-v-654d8c19"]])},{path:"/toolbox/watermark",name:"Watermark",component:Ra(w({__name:"watermark-tool",setup(e){const t=Ca(),a=V({enable:!0,text:"",fontSize:0,opacity:0,position:yt.rightBottom,textColor:""}),i=I(null),l=I([]),s=I(!1),c=I(!1),d=e=>{c.value=!1,s.value=!1,e.forEach((e=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:e.uuid,originalName:e.file.name,originalSize:e.file.size,originalBase64:e.base64,originalFile:e.file})}))},u=e=>{a.text=e.text,a.textColor=e.textColor,a.opacity=e.opacity,a.position=e.position,a.fontSize=e.fontSize,c.value=!1},m=()=>{var e;t.dispatch("TOOLBOX_IMG_LIST_RESET"),c.value=!1,null==(e=i.value)||e.reset()},g=async()=>{s.value=!0;for(const e of l.value)e.processing=!0,e.finialFile=await Mt(e.originalFile,a),e.finialBase64=await ia(e.finialFile)||"",e.finialSize=e.finialFile.size,e.finialName=e.finialFile.name,e.processing=!1;c.value=!0,s.value=!1},p=()=>{l.value.forEach((e=>{la(e.finialFile)}))},h=e=>{var a;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",e),null==(a=i.value)||a.remove(e)};return F((()=>t.state.toolboxImageListModule.toolboxImageList),(e=>{l.value=e}),{immediate:!0,deep:!0}),(e,t)=>{const _=Pn,f=gi,v=ms,b=x;return n(),o("div",Bn,[l.value.length?(n(),o("div",Vn,[(n(!0),o(R,null,P(l.value,(e=>(n(),E(_,{"img-obj":e,key:e.uuid,"card-type":"watermark",onRemove:h},null,8,["img-obj"])))),128))])):D("",!0),r("div",{class:N(["watermark-tool-right",{"no-img":!l.value.length}])},[T(f,{ref_key:"gettingImagesRef",ref:i,onGetImgList:d},null,512),T(v,{isTool:!0,onWatermarkConfig:u,style:{"margin-top":"18rem"}}),r("div",{class:N(["user-operate",{watermarked:c.value&&l.value.length>1}])},[c.value&&l.value.length>1?(n(),E(b,{key:0,plain:"",type:"success",onClick:p},{default:O((()=>[$(L(e.$t("toolbox.batch_download")),1)])),_:1})):D("",!0),r("div",null,[l.value.length?(n(),E(b,{key:0,plain:"",type:"warning",onClick:m},{default:O((()=>[$(L(e.$t("reset")),1)])),_:1})):D("",!0),l.value.length?(n(),E(b,{key:1,disabled:s.value||c.value||!a.text,plain:"",type:"primary",onClick:g},{default:O((()=>[$(L(e.$t("toolbox.add_watermark")),1)])),_:1},8,["disabled"])):D("",!0)])],2)],2)])}}}),[["__scopeId","data-v-8c458a98"]])}]},{path:"/feedback",name:"feedback",component:Ln,meta:{title:"nav.feedback"}},{path:"/:catchAll(.*)",redirect:"/"}],Xn=$e({history:Ee(),routes:Fn});Xn.beforeEach(((e,t,a)=>{e.meta.title&&zt(e.meta.title),a()}));const Wn=()=>{const e=Ca(),t=async e=>{await De((()=>{const t=document.getElementsByTagName("html")[0];e===It.dark&&(t.classList.remove("light"),t.classList.add("dark")),e===It.light&&(t.classList.remove("dark"),t.classList.add("light"))}))},a=async e=>{e===It.system?await t(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?It.dark:It.light):await t(e)};F((()=>e.getters.getUserSettings.theme.mode),(async e=>{await a(e)}),{deep:!0,immediate:!0})},qn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Jn=[r("path",{fill:"currentColor",d:"M288 320a224 224 0 1 0 448 0a224 224 0 1 0-448 0m544 608H160a32 32 0 0 1-32-32v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 0 1-32 32z"},null,-1)];var Kn={name:"ep-user-filled",render:function(e,t){return n(),o("svg",qn,[...Jn])}};const Zn={id:"busuanzi_value_site_uv",class:"uv"},Yn={id:"busuanzi_value_site_pv",class:"pv"},Qn=w({__name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(e){const t=e,a=I(null),i=I(!1),l=y((()=>!0));return k((()=>{const e=document.createElement("script");e.async=!0,e.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",a.value.appendChild(e),e.onload=()=>{const e=setTimeout((()=>{var l,s;l=a.value,s=t.isuv,l.querySelector(`.${s?"u":"p"}v`).innerText&&(i.value=!0),clearTimeout(e)}),1500)}})),(t,s)=>K((n(),o("span",{class:"site-count",ref_key:"siteCountDom",ref:a},[K(r("span",Zn,null,512),[[se,e.isuv]]),K(r("span",Yn,null,512),[[se,!e.isuv]]),$("+ "+L(t.$t("header.usage_count")),1)],512)),[[se,i.value&&l.value]])}});const eo=e=>(H("data-v-a2688538"),e=e(),B(),e),to={class:"header"},ao={class:"header-left"},io=[eo((()=>r("div",{class:"logo"},[r("img",{src:"./assets/logo.ffee4291.png",alt:"PicX"})],-1))),eo((()=>r("div",{class:"title"},"PicX",-1)))],lo={class:"website-count"},so={class:"header-right"},no={class:"user-info"},oo={class:"avatar-box"},ro={class:"avatar flex-center"},co=["src","alt"],uo={class:"personal-center-popover"},mo={class:"content-item"},go={class:"flex-center"},po={class:"content-item"},ho={class:"flex-center"};var _o=Ra(w({__name:"header-content",setup(e){const t=Y(),a=Ca(),i=y((()=>a.getters.getUserConfigInfo)).value,l=y((()=>a.getters.getUserSettings)).value,s=()=>{a.dispatch("USER_SETTINGS_PERSIST")},c=()=>{a.dispatch("LOGOUT"),t.push("/login"),document.body.click(),setTimeout((()=>{window.location.reload()}))},d=()=>{i.owner?window.open(`https://github.com/${i.owner}/${i.selectedRepo}`):t.push("/config")};return(e,a)=>{const u=Qn,m=Kn,g=S,p=Ei,h=Ie,_=ke,f=ce,v=Ae;return n(),o("header",to,[r("div",ao,[r("div",{class:"brand",onClick:a[0]||(a[0]=e=>C(t).push("/"))},io),r("div",lo,[T(u,{isuv:!1})])]),r("div",so,[r("div",no,[r("div",{class:"username",onClick:d},L(C(i).owner?C(i).owner:e.$t("header.not_login")),1),T(v,{placement:"bottom-end",trigger:"click",width:"220rem","show-arrow":!1,"popper-style":{padding:"0"}},{reference:O((()=>{var e,t,a;return[r("div",oo,[r("div",ro,[(null==(e=C(i))?void 0:e.avatarUrl)?(n(),o("img",{key:0,src:null==(t=C(i))?void 0:t.avatarUrl,alt:null==(a=C(i))?void 0:a.owner},null,8,co)):(n(),E(g,{key:1,class:"user-filled-icon"},{default:O((()=>[T(m)])),_:1}))]),T(g,{class:"caret-bottom-icon"},{default:O((()=>[T(p)])),_:1})])]})),default:O((()=>[r("ul",uo,[r("li",mo,[r("span",go,L(e.$t("header.language")),1),T(_,{size:"small",style:{width:"100rem"},modelValue:C(l).language,"onUpdate:modelValue":a[1]||(a[1]=e=>C(l).language=e),onChange:s},{default:O((()=>[T(h,{label:"中文简体",value:C(xt).zhCN},null,8,["value"]),T(h,{label:"中文繁體",value:C(xt).zhTW},null,8,["value"]),T(h,{label:"English",value:C(xt).en},null,8,["value"])])),_:1},8,["modelValue"])]),T(f,{style:{margin:"5px 0"}}),r("li",po,[r("span",ho,L(e.$t("header.theme")),1),T(_,{size:"small",style:{width:"100rem"},modelValue:C(l).theme.mode,"onUpdate:modelValue":a[2]||(a[2]=e=>C(l).theme.mode=e),onChange:s},{default:O((()=>[T(h,{label:e.$t("settings.theme.system"),value:C(It).system},null,8,["label","value"]),T(h,{label:e.$t("settings.theme.light"),value:C(It).light},null,8,["label","value"]),T(h,{label:e.$t("settings.theme.dark"),value:C(It).dark},null,8,["label","value"])])),_:1},8,["modelValue"])]),T(f,{style:{margin:"5px 0"}}),C(i).name||C(i).owner?(n(),o("li",{key:0,class:"content-item",onClick:c},L(e.$t("header.logout")),1)):(n(),o("li",{key:1,class:"content-item",onClick:a[3]||(a[3]=e=>C(t).push("/login"))},L(e.$t("header.login")),1))])])),_:1})])])])}}}),[["__scopeId","data-v-a2688538"]]);const fo={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},vo=[r("path",{fill:"currentColor",d:"M389.44 768a96.064 96.064 0 0 1 181.12 0H896v64H570.56a96.064 96.064 0 0 1-181.12 0H128v-64zm192-288a96.064 96.064 0 0 1 181.12 0H896v64H762.56a96.064 96.064 0 0 1-181.12 0H128v-64zm-320-288a96.064 96.064 0 0 1 181.12 0H896v64H442.56a96.064 96.064 0 0 1-181.12 0H128v-64z"},null,-1)];var bo={name:"ep-operation",render:function(e,t){return n(),o("svg",fo,[...vo])}};const yo={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},wo=[r("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640z"},null,-1),r("path",{fill:"currentColor",d:"m469.952 554.24l52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"},null,-1)];var Io={name:"ep-edit",render:function(e,t){return n(),o("svg",yo,[...wo])}};const ko={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},xo=[r("path",{fill:"currentColor",d:"M160 160v704h704V160zm-32-64h768a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H128a32 32 0 0 1-32-32V128a32 32 0 0 1 32-32"},null,-1),r("path",{fill:"currentColor",d:"M384 288q64 0 64 64t-64 64t-64-64t64-64M185.408 876.992l-50.816-38.912L350.72 556.032a96 96 0 0 1 134.592-17.856l1.856 1.472l122.88 99.136a32 32 0 0 0 44.992-4.864l216-269.888l49.92 39.936l-215.808 269.824l-.256.32a96 96 0 0 1-135.04 14.464l-122.88-99.072l-.64-.512a32 32 0 0 0-44.8 5.952z"},null,-1)];var So={name:"ep-picture",render:function(e,t){return n(),o("svg",ko,[...xo])}};const To={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Oo=[r("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357 357 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a352 352 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357 357 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088l-24.512 11.968a294 294 0 0 0-34.816 20.096l-22.656 15.36l-116.224-25.088l-65.28 113.152l79.68 88.192l-1.92 27.136a293 293 0 0 0 0 40.192l1.92 27.136l-79.808 88.192l65.344 113.152l116.224-25.024l22.656 15.296a294 294 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152l24.448-11.904a288 288 0 0 0 34.752-20.096l22.592-15.296l116.288 25.024l65.28-113.152l-79.744-88.192l1.92-27.136a293 293 0 0 0 0-40.256l-1.92-27.136l79.808-88.128l-65.344-113.152l-116.288 24.96l-22.592-15.232a288 288 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384a192 192 0 0 1 0-384m0 64a128 128 0 1 0 0 256a128 128 0 0 0 0-256"},null,-1)];var Lo={name:"ep-setting",render:function(e,t){return n(),o("svg",To,[...Oo])}};const Co={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},$o=[r("path",{fill:"currentColor",d:"M128 384v448h768V384zm-32-64h832a32 32 0 0 1 32 32v512a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V352a32 32 0 0 1 32-32m64-128h704v64H160zm96-128h512v64H256z"},null,-1)];var Eo={name:"ep-files",render:function(e,t){return n(),o("svg",Co,[...$o])}};const Do={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ao=[r("path",{fill:"currentColor",d:"m174.72 855.68l135.296-45.12l23.68 11.84C388.096 849.536 448.576 864 512 864c211.84 0 384-166.784 384-352S723.84 160 512 160S128 326.784 128 512c0 69.12 24.96 139.264 70.848 199.232l22.08 28.8l-46.272 115.584zm-45.248 82.56A32 32 0 0 1 89.6 896l58.368-145.92C94.72 680.32 64 596.864 64 512C64 299.904 256 96 512 96s448 203.904 448 416s-192 416-448 416a461.06 461.06 0 0 1-206.912-48.384l-175.616 58.56z"},null,-1),r("path",{fill:"currentColor",d:"M512 563.2a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4m192 0a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4m-384 0a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4"},null,-1)];var Ro={name:"ep-chat-dot-round",render:function(e,t){return n(),o("svg",Do,[...Ao])}};const Po=be([{uuid:At(),name:"nav.config",icon:Io,isActive:!1,path:"/config",isShow:!0},{uuid:At(),name:"nav.upload",icon:Ii,isActive:!1,path:"/upload",isShow:!0},{uuid:At(),name:"nav.management",icon:So,isActive:!1,path:"/management",isShow:!0},{uuid:At(),name:"nav.settings",icon:Lo,isActive:!1,path:"/settings",isShow:!0},{uuid:At(),name:"nav.toolbox",icon:Eo,isActive:!1,path:"/toolbox",isShow:!0},{uuid:At(),name:"nav.feedback",icon:Ro,isActive:!1,path:"/feedback",isShow:!0}]);const No={class:"nav"},Uo={class:"nav-list"},zo=["onClick"],Go={class:"nav-content"},Mo={class:"nav-name"},jo={class:"nav-item quick-actions flex-center"},Ho={class:"nav-content"},Bo={class:"nav-name"},Vo={class:"quick-actions-popover"};var Fo=Ra(w({__name:"nav-content",setup(e){const t=Y(),a=Ca(),i=y((()=>a.getters.getUserConfigInfo)).value,l=y((()=>a.getters.getUserSettings)).value,s=y((()=>{switch(l.elementPlusSize){case vt.small:return 22;case vt.large:return 30;default:return 26}})),c=e=>{Po.value.forEach((t=>{const a=t;return a.isActive=t.path===e||e.includes(t.path),a})),Re(Po)},d=()=>{a.dispatch("USER_SETTINGS_PERSIST")};return F((()=>t.currentRoute.value),(e=>{c(e.path)})),F((()=>i.logined),(e=>{Po.value.forEach((t=>{switch(t.path){case"/management":case"/settings":t.isShow=e}}))}),{deep:!0,immediate:!0}),k((()=>{t.isReady().then((()=>{c(t.currentRoute.value.path)}))})),(e,a)=>{const c=S,m=bo,g=ye,p=Ae;return n(),o("aside",No,[r("ul",Uo,[(n(!0),o(R,null,P(C(Po),((a,l)=>K((n(),o("li",{class:N(["nav-item flex-center",{active:a.isActive}]),key:l+a.uuid,onClick:e=>(e=>{const{path:a}=e;if("/management"===a){if(""===i.selectedRepo)return u.warning(Et.global.t("upload.message2")),void t.push("/config");if(""===i.selectedDir)return u.warning(Et.global.t("upload.message3")),void t.push("/config")}t.push(a)})(a)},[r("div",Go,[T(c,{size:s.value},{default:O((()=>[(n(),E(Le(a.icon)))])),_:2},1032,["size"]),r("span",Mo,L(e.$t(a.name)),1)])],10,zo)),[[se,a.isShow]]))),128))]),r("div",jo,[T(p,{placement:"right-end",width:"en"===C(l).language?"230rem":"190rem",trigger:"click","show-arrow":!1,"popper-style":{padding:"0"}},{reference:O((()=>[r("div",Ho,[T(c,{size:s.value},{default:O((()=>[T(m)])),_:1},8,["size"]),r("span",Bo,L(e.$t("nav.actions")),1)])])),default:O((()=>[r("div",Vo,[T(g,{modelValue:C(l).watermark.enable,"onUpdate:modelValue":a[0]||(a[0]=e=>C(l).watermark.enable=e),class:"mb-2","active-text":e.$t("actions.watermark"),onChange:d},null,8,["modelValue","active-text"]),T(g,{modelValue:C(l).compress.enable,"onUpdate:modelValue":a[1]||(a[1]=e=>C(l).compress.enable=e),class:"mb-2","active-text":e.$t("actions.compress"),onChange:d},null,8,["modelValue","active-text"]),T(g,{modelValue:C(l).imageLinkFormat.enable,"onUpdate:modelValue":a[2]||(a[2]=e=>C(l).imageLinkFormat.enable=e),class:"mb-2","active-text":e.$t("actions.transform")+C(l).imageLinkFormat.selected,onChange:d},null,8,["modelValue","active-text"])])])),_:1},8,["width"])])])}}}),[["__scopeId","data-v-1a83c6f8"]]);const Xo={class:"main-container"},Wo={class:"top-container"},qo={class:"bottom-container"},Jo={class:"bottom-content"},Ko={class:"left"},Zo={class:"right"};var Yo=Ra(w({__name:"main-container",setup(e){const t=y((()=>Oa.getters.getUserConfigInfo)).value,a=async()=>{const e=await Xa();var t;e&&(t=e.content,Oa.dispatch("SET_USER_SETTINGS",{deploy:JSON.parse(window.atob(t))}))};return k((()=>{Wn()})),F((()=>t.selectedBranch),(e=>{e&&t.owner&&t.selectedRepo&&a()}),{immediate:!0,deep:!0}),(e,t)=>{const a=Oe("router-view");return n(),o("main",Xo,[r("div",Wo,[T(_o)]),r("div",qo,[r("div",Jo,[r("div",Ko,[T(Fo)]),r("div",Zo,[T(a)])])])])}}}),[["__scopeId","data-v-3840d513"]]);const Qo=w({__name:"App",setup(e){const t=Z(),a=Ca(),i=y((()=>a.getters.getUserSettings)).value,l=I(vt.default),s=I(Ne),o=e=>{e<=600?(null==a||a.dispatch("SET_USER_SETTINGS",{elementPlusSize:vt.small}),l.value=vt.small):e<=900?(null==a||a.dispatch("SET_USER_SETTINGS",{elementPlusSize:vt.default}),l.value=vt.default):(null==a||a.dispatch("SET_USER_SETTINGS",{elementPlusSize:vt.large}),l.value=vt.large)},r=e=>{e===xt.zhCN?(s.value=Ne,t.proxy.$i18n.locale="zh-CN"):e===xt.zhTW?(s.value=Ue,t.proxy.$i18n.locale="zh-TW"):e===xt.en?(s.value=ze,t.proxy.$i18n.locale="en"):(s.value=Ne,t.proxy.$i18n.locale="zh-CN"),zt(Xn.currentRoute.value.meta.title)},c=()=>{(async()=>{try{const e=await d.get("https://api.ipify.org?format=json"),t=await d.get(`https://ipapi.co/${e.data.ip}/country/`);return Promise.resolve(t.data)}catch(e){return Promise.resolve("CN")}})().then((e=>{var l,s,n,o,c;const d=(e=>"CN"===e?xt.zhCN:"HK"===e||"TW"===e||"MO"===e?xt.zhTW:xt.en)(e);if(d!==i.language){const i=null==(l=null==t?void 0:t.proxy)?void 0:l.$t("confirm",d),m=null==(o=null==t?void 0:t.proxy)?void 0:o.$t("toggle_language_msg",d,{region:null==(s=null==t?void 0:t.proxy)?void 0:s.$t(`region.${e}`,d),language:null==(n=null==t?void 0:t.proxy)?void 0:n.$t(`language.${d}`,d)}),g=u({customClass:"custom-message-container",duration:0,offset:20,type:"info",message:`<div class="content-box language">\n                    <span class="msg">${m}</span>\n                    <spna class="btn-box">\n                      <span class="confirm btn">${i}</span>\n                    </spna>\n                  </div>`,dangerouslyUseHTMLString:!0,showClose:!0});null==(c=document.querySelector(".custom-message-container .language .confirm"))||c.addEventListener("click",(()=>{r(d),a.dispatch("SET_USER_SETTINGS",{language:d}),g.close()}))}}))},m=()=>{o(window.innerWidth),window.addEventListener("resize",((e,t=500)=>{let a,i;return function(...l){i=l,a||(a=setTimeout((()=>{e(...i),a=void 0}),t))}})((e=>{o(e.target.innerWidth)}),600)),Wn(),r(i.language),c(),(async()=>{const{authorized:e,installed:t,token:a,isAutoAuthorize:i}=y((()=>Oa.getters.getGitHubAuthorizationInfo)).value,l=async()=>{await Xn.push({path:"/login",query:{jump:"0"}})};i&&e&&t&&a&&$a()&&(u.error({message:Et.global.t("authorization.msg_1"),duration:0,showClose:!0,onClose:()=>{l()}}),await l())})()};return F((()=>i.language),(e=>{r(e)})),k((()=>{m()})),(e,t)=>(n(),E(C(Pe),{size:l.value,"z-index":3e3,locale:s.value},{default:O((()=>[T(Yo)])),_:1},8,["size","locale"]))}});const er="custom-contextmenu-container";let tr=null,ar=!1;const ir={mounted(e,t){e.addEventListener("contextmenu",(e=>{const{dir:a,type:i,img:l}=t.value;e.preventDefault(),e.stopPropagation();const s=y((()=>Oa.getters.getUserViewDir)).value,n=a?`${"/"===s?"":`${s}/`}${a}`:s;tr=document.querySelector(`.${er}`),tr||(tr=document.createElement("ul"),tr.setAttribute("class",er),tr.style.position="fixed",tr.style.zIndex="1000",tr.innerHTML=`<li class="custom-contextmenu-item upload-image"></li><li class="custom-contextmenu-item copy-link">${Et.global.t("copy_link")}</li>`,document.body.appendChild(tr));const o=null==tr?void 0:tr.querySelector(".upload-image"),r=null==tr?void 0:tr.querySelector(".copy-link");i===Tt.img?(r.style.display="block",o.innerHTML=Et.global.t("management.contextmenu_1")):(r.style.display="none",o.innerHTML=Et.global.t("management.contextmenu_2",{dir:"/"===n?Et.global.t("management.contextmenu_3"):n}));let c=e.clientX,d=e.clientY;const u=tr.clientWidth,m=tr.clientHeight,g=document.documentElement.clientWidth,p=document.documentElement.clientHeight;u+c>g&&(c=g-u-6),m+d>p&&(d=p-m-6),tr.style.top=`${d}px`,tr.style.left=`${c}px`,ar||(ar=!0,null==o||o.addEventListener("click",(async()=>{const e="/"===n?_t.rootDir:_t.repoDir,t="/"===n?[]:n.split("/");await Oa.dispatch("SET_USER_CONFIG_INFO",{dirMode:e,selectedDir:n,selectedDirList:t}),await Xn.push("/upload")})),null==r||r.addEventListener("click",(async()=>{const e=y((()=>Oa.getters.getUserConfigInfo)).value,t=y((()=>Oa.getters.getUserSettings)).value;pa(l,e,t)})));const h=()=>{tr&&(document.removeEventListener("click",h),document.body.removeChild(tr),tr=null,ar=!1)};document.addEventListener("click",h)}))}},lr=Ge(Qo);lr.directive("contextmenu",ir),lr.use(Xn).use(Oa,La).use(Et).mount("#app");export{pt as B,_t as D,vt as E,Qe as G,Ke as I,xt as L,et as P,rl as _,Ze as a,Ra as b,bi as c,bl as d,Xn as e,Et as f,qt as g,Ye as h,$a as i,Ut as j,ei as k,Ft as l,Vt as r,Oa as s,Ca as u};
